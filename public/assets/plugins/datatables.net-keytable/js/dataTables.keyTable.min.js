/*! For license information please see dataTables.keyTable.min.js.LICENSE.txt */
!function(e){var t,n;"function"==typeof define&&define.amd?define(["jquery","datatables.net"],(function(t){return e(t,window,document)})):"object"==typeof exports?(t=require("jquery"),n=function(e,t){t.fn.dataTable||require("datatables.net")(e,t)},"undefined"==typeof window?module.exports=function(i,s){return i=i||window,s=s||t(i),n(i,s),e(s,i,i.document)}:(n(window,t),module.exports=e(t,window,window.document))):e(jQuery,window,document)}((function(e,t,n){"use strict";function i(t,n){if(!s.versionCheck||!s.versionCheck("1.10.8"))throw"KeyTable requires DataTables 1.10.8 or newer";if(this.c=e.extend(!0,{},s.defaults.keyTable,i.defaults,n),this.s={dt:new s.Api(t),dtDrawing:!1,enable:!0,focusDraw:!1,waitingForDraw:!1,lastFocus:null,namespace:".keyTable-"+o++,tabInput:null},this.dom={},t=(n=this.s.dt.settings()[0]).keytable)return t;(n.keytable=this)._constructor()}var s=e.fn.dataTable,o=0,l=0;return e.extend(i.prototype,{blur:function(){this._blur()},enable:function(e){this.s.enable=e},enabled:function(){return this.s.enable},focus:function(e,t){this._focus(this.s.dt.cell(e,t))},focused:function(e){var t;return!!this.s.lastFocus&&(t=this.s.lastFocus.cell.index(),e.row===t.row)&&e.column===t.column},_constructor:function(){this._tabInput();var t,i=this,s=this.s.dt,o=e(s.table().node()),l=this.s.namespace,a=!1,r=("static"===o.css("position")&&o.css("position","relative"),e(s.table().body()).on("click"+l,"th, td",(function(e){var t;!1!==i.s.enable&&(t=s.cell(this)).any()&&i._focus(t,null,!1,e)})),e(n).on("keydown"+l,(function(e){a||i.s.dtDrawing?e.preventDefault():i._key(e)})),this.c.blurable&&e(n).on("mousedown"+l,(function(t){e(t.target).parents(".dataTables_filter, .dt-search").length&&i._blur(),e(t.target).parents().filter(s.table().container()).length||e(t.target).parents("div.DTE").length||e(t.target).parents("div.editor-datetime").length||e(t.target).parents("div.dt-datetime").length||e(t.target).parents().filter(".DTFC_Cloned").length||i._blur()})),this.c.editor&&((t=this.c.editor).on("open.keyTableMain",(function(e,n,s){"inline"!==n&&i.s.enable&&(i.enable(!1),t.one("close"+l,(function(){i.enable(!0)})))})),this.c.editOnFocus&&s.on("key-focus"+l+" key-refocus"+l,(function(e,t,n,s){i._editor(null,s,!0)})),s.on("key"+l,(function(e,t,n,s,o){i._editor(n,o,!1)})),e(s.table().body()).on("dblclick"+l,"th, td",(function(e){!1===i.s.enable||!s.cell(this).any()||i.s.lastFocus&&this!==i.s.lastFocus.cell.node()||i._editor(null,e,!0)})),t.on("preSubmit",(function(){a=!0})).on("preSubmitCancelled",(function(){a=!1})).on("submitComplete",(function(){a=!1}))),s.on("stateSaveParams"+l,(function(e,t,n){n.keyTable=i.s.lastFocus?i.s.lastFocus.cell.index():null})),s.on("column-visibility"+l,(function(e){i._tabInput()})),s.on("column-reorder"+l,(function(e,t,n){var s,o=i.s.lastFocus;o&&o.cell&&(s=o.relative.column,o.cell[0][0].column=n.mapping.indexOf(s),o.relative.column=n.mapping.indexOf(s))})),s.on("preDraw"+l+" scroller-will-draw"+l,(function(e){i.s.dtDrawing=!0})),s.on("draw"+l,(function(e){var t,n,o;i.s.dtDrawing=!1,i._tabInput(),i.s.focusDraw||i.s.lastFocus&&(t=i.s.lastFocus.relative,n=s.page.info(),o=t.row,0===n.recordsDisplay||o<n.start||o>n.start+n.length||(o>=n.recordsDisplay&&(o=n.recordsDisplay-1),i._focus(o,t.column,!0,e)))})),this.c.clipboard&&this._clipboard(),s.on("destroy"+l,(function(){i._blur(!0),s.off(l),e(s.table().body()).off("click"+l,"th, td").off("dblclick"+l,"th, td"),e(n).off("mousedown"+l).off("keydown"+l).off("copy"+l).off("paste"+l)})),s.state.loaded());r&&r.keyTable?s.one("init",(function(){var e=s.cell(r.keyTable);e.any()&&e.focus()})):this.c.focus&&s.cell(this.c.focus).focus()},_blur:function(t){var n;this.s.enable&&this.s.lastFocus&&(n=this.s.lastFocus.cell,e(n.node()).removeClass(this.c.className),this.s.lastFocus=null,t||(this._updateFixedColumns(n.index().column),this._emitEvent("key-blur",[this.s.dt,n])))},_clipboard:function(){var i=this.s.dt,s=this,o=this.s.namespace,l=this.c.clipboard;t.getSelection&&(!0!==l&&!l.copy||e(n).on("copy"+o,(function(e){e=e.originalEvent;var n=t.getSelection().toString(),i=s.s.lastFocus;!n&&i&&(e.clipboardData.setData("text/plain",i.cell.render(s.c.clipboardOrthogonal)),e.preventDefault())})),!0!==l&&!l.paste||e(n).on("paste"+o,(function(e){e=e.originalEvent;var o,l=s.s.lastFocus,a=n.activeElement,r=s.c.editor;!l||a&&"body"!==a.nodeName.toLowerCase()||(e.preventDefault(),t.clipboardData&&t.clipboardData.getData?o=t.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(o=e.clipboardData.getData("text/plain")),r?(a=s._inlineOptions(l.cell.index()),r.inline(a.cell,a.field,a.options).set(r.displayed()[0],o).submit()):(l.cell.data(o),i.draw(!1)))})))},_columns:function(){var e=this.s.dt,t=e.columns(this.c.columns).indexes(),n=[];return e.columns(":visible").every((function(e){-1!==t.indexOf(e)&&n.push(e)})),n},_editor:function(t,i,s){var o,a,r,c,u,d;!this.s.lastFocus||i&&"draw"===i.type||(a=(o=this).s.dt,r=this.c.editor,c=this.s.lastFocus.cell,u=this.s.namespace+"e"+l++,e("div.DTE",c.node()).length)||null!==t&&(0<=t&&t<=9||11===t||12===t||14<=t&&t<=31||112<=t&&t<=123||127<=t&&t<=159)||(i&&(i.stopPropagation(),13===t)&&i.preventDefault(),d=function(){var t=o._inlineOptions(c.index());r.one("open"+u,(function(){r.off("cancelOpen"+u),s||e("div.DTE_Field_InputControl input, div.DTE_Field_InputControl textarea").select(),a.keys.enable(s?"tab-only":"navigation-only"),a.on("key-blur.editor",(function(e,t,n){"submit"!==r.s.editOpts.onBlur&&r.displayed()&&n.node()===c.node()&&r.submit()})),s&&e(a.table().container()).addClass("dtk-focus-alt"),r.on("preSubmitCancelled"+u,(function(){setTimeout((function(){o._focus(c,null,!1)}),50)})),r.on("submitUnsuccessful"+u,(function(){o._focus(c,null,!1)})),r.one("close"+u,(function(){a.keys.enable(!0),a.off("key-blur.editor"),r.off(u),e(a.table().container()).removeClass("dtk-focus-alt"),o.s.returnSubmit&&(o.s.returnSubmit=!1,o._emitEvent("key-return-submit",[a,c]))}))})).one("cancelOpen"+u,(function(){r.off(u)})).inline(t.cell,t.field,t.options)},13===t?(s=!0,e(n).one("keyup",(function(){d()}))):d())},_inlineOptions:function(e){return this.c.editorOptions?this.c.editorOptions(e):{cell:e,field:void 0,options:void 0}},_emitEvent:function(t,n){return this.s.dt.iterator("table",(function(i,s){return e(i.nTable).triggerHandler(t,n)}))},_focus:function(i,s,o,l){var a=this,r=this.s.dt,c=r.page.info(),u=this.s.lastFocus;if(l=l||null,this.s.enable){if("number"!=typeof i){if(!i.any())return;var d=i.index();if(s=d.column,(i=r.rows({filter:"applied",order:"applied"}).indexes().indexOf(d.row))<0)return;c.serverSide&&(i+=c.start)}if(-1!==c.length&&(i<c.start||i>=c.start+c.length))this.s.focusDraw=!0,this.s.waitingForDraw=!0,r.one("draw",(function(){a.s.focusDraw=!1,a.s.waitingForDraw=!1,a._focus(i,s,void 0,l)})).page(Math.floor(i/c.length)).draw(!1);else if(-1!==e.inArray(s,this._columns())&&(c.serverSide&&(i-=c.start),d=r.cells(null,s,{search:"applied",order:"applied"}).flatten(),c=r.cell(d[i]),-1===(d=this._emitEvent("key-prefocus",[this.s.dt,c,l||null])).indexOf(!1))){if(u){if(u.node===c.node())return void this._emitEvent("key-refocus",[this.s.dt,c,l||null]);this._blur()}this._removeOtherFocus(),(d=e(c.node())).addClass(this.c.className),this._updateFixedColumns(s),void 0!==o&&!0!==o||(this._scroll(e(t),e(n.body),d,"offset"),(u=r.table().body().parentNode)!==r.table().header().parentNode&&(o=e(u.parentNode),this._scroll(o,o,d,"position"))),u=r.page.info(),this.s.lastFocus={cell:c,node:c.node(),relative:{row:u.start+r.rows({page:"current"}).indexes().indexOf(c.index().row),column:c.index().column}},this._emitEvent("key-focus",[this.s.dt,c,l||null]),r.state.save()}}},_key:function(t){if(this.s.waitingForDraw)t.preventDefault();else if(!e(t.target).closest(".dte-inlineAdd").length){var n=this.s.enable,i=(this.s.returnSubmit=("navigation-only"===n||"tab-only"===n)&&13===t.keyCode,!0===n||"navigation-only"===n);if(n&&(!(0===t.keyCode||t.ctrlKey||t.metaKey||t.altKey)||t.ctrlKey&&t.altKey)){var s=this.s.lastFocus;if(s)if(this.s.dt.cell(s.node).any()){var o=this,l=this.s.dt,a=!!this.s.dt.settings()[0].oScroll.sY;if(!this.c.keys||-1!==e.inArray(t.keyCode,this.c.keys))switch(t.keyCode){case 9:t.preventDefault(),this._keyAction((function(){o._shift(t,t.shiftKey?"left":"right",!0)}));break;case 27:e(s.node).find("div.DTE").length||this.c.blurable&&!0===n&&this._blur();break;case 33:case 34:i&&!a&&(t.preventDefault(),this._keyAction((function(){l.page(33===t.keyCode?"previous":"next").draw(!1)})));break;case 35:case 36:i&&(t.preventDefault(),this._keyAction((function(){var e=l.cells({page:"current"}).indexes(),n=o._columns();o._focus(l.cell(e[35===t.keyCode?e.length-1:n[0]]),null,!0,t)})));break;case 37:i&&this._keyAction((function(){o._shift(t,"left")}));break;case 38:i&&this._keyAction((function(){o._shift(t,"up")}));break;case 39:i&&this._keyAction((function(){o._shift(t,"right")}));break;case 40:i&&this._keyAction((function(){o._shift(t,"down")}));break;case 113:if(this.c.editor){this._editor(null,t,!0);break}default:!0===n&&this._emitEvent("key",[l,t.keyCode,this.s.lastFocus.cell,t])}}else this.s.lastFocus=null}}},_keyAction:function(e){var t=this.c.editor;t&&t.mode()&&t.display()?t.submit(e):e()},_removeOtherFocus:function(){var t=this.s.dt.table().node();e.fn.dataTable.tables({api:!0}).iterator("table",(function(e){this.table().node()!==t&&this.cell.blur()}))},_scroll:function(e,t,n,i){var s=n[i](),o=n.outerHeight(),l=n.outerWidth(),a=t.scrollTop(),r=t.scrollLeft(),c=e.height();e=e.width();"position"===i&&(s.top+=parseInt(n.closest("table").css("top"),10)),s.top<a&&s.top+o>a-5&&t.scrollTop(s.top),s.left<r&&t.scrollLeft(s.left),s.top+o>a+c&&s.top<a+c+5&&o<c&&t.scrollTop(s.top+o-c),s.left+l>r+e&&l<e&&t.scrollLeft(s.left+l-e)},_shift:function(t,n,i){var s,o=this.s.dt,l=o.page.info(),a=l.recordsDisplay,r=this._columns(),c=this.s.lastFocus;c&&(c=c.cell)&&(s=o.rows({filter:"applied",order:"applied"}).indexes().indexOf(c.index().row),l.serverSide&&(s+=l.start),l=s,c=r[s=o.columns(r).indexes().indexOf(c.index().column)],"rtl"===e(o.table().node()).css("direction")&&("right"===n?n="left":"left"===n&&(n="right")),"right"===n?c=s>=r.length-1?(l++,r[0]):r[s+1]:"left"===n?c=0===s?(l--,r[r.length-1]):r[s-1]:"up"===n?l--:"down"===n&&l++,0<=l&&l<a&&-1!==e.inArray(c,r)?(t&&t.preventDefault(),this._focus(l,c,!0,t)):i&&this.c.blurable?this._blur():t&&t.preventDefault())},_tabInput:function(){var t=this,n=this.s.dt,i=null!==this.c.tabIndex?this.c.tabIndex:n.settings()[0].iTabIndex;-1!=i&&(this.s.tabInput||((i=e('<div><input type="text" tabindex="'+i+'"/></div>').css({position:"absolute",height:1,width:0,overflow:"hidden"})).children().on("focus",(function(e){var i=n.cell(":eq(0)",t._columns(),{page:"current"});i.any()&&t._focus(i,null,!0,e)})),this.s.tabInput=i),i=this.s.dt.cell(":eq(0)","0:visible",{page:"current",order:"current"}).node())&&e(i).prepend(this.s.tabInput)},_updateFixedColumns:function(e){var t,n=this.s.dt,i=n.settings()[0];i._oFixedColumns&&(t=i._oFixedColumns.s.iLeftColumns,i=i.aoColumns.length-i._oFixedColumns.s.iRightColumns,e<t||i<=e)&&n.fixedColumns().update()}}),i.defaults={blurable:!0,className:"focus",clipboard:!0,clipboardOrthogonal:"display",columns:"",editor:null,editOnFocus:!1,editorOptions:null,focus:null,keys:null,tabIndex:null},i.version="2.12.1",e.fn.dataTable.KeyTable=i,e.fn.DataTable.KeyTable=i,s.Api.register("cell.blur()",(function(){return this.iterator("table",(function(e){e.keytable&&e.keytable.blur()}))})),s.Api.register("cell().focus()",(function(){return this.iterator("cell",(function(e,t,n){e.keytable&&e.keytable.focus(t,n)}))})),s.Api.register("keys.disable()",(function(){return this.iterator("table",(function(e){e.keytable&&e.keytable.enable(!1)}))})),s.Api.register("keys.enable()",(function(e){return this.iterator("table",(function(t){t.keytable&&t.keytable.enable(void 0===e||e)}))})),s.Api.register("keys.enabled()",(function(e){var t=this.context;return!!t.length&&!!t[0].keytable&&t[0].keytable.enabled()})),s.Api.register("keys.move()",(function(e){return this.iterator("table",(function(t){t.keytable&&t.keytable._shift(null,e,!1)}))})),s.ext.selector.cell.push((function(e,t,n){var i=t.focused,s=e.keytable,o=[];if(!s||void 0===i)return n;for(var l=0,a=n.length;l<a;l++)(!0===i&&s.focused(n[l])||!1===i&&!s.focused(n[l]))&&o.push(n[l]);return o})),e(n).on("preInit.dt.dtk",(function(t,n,o){var l,a;"dt"===t.namespace&&(t=n.oInit.keys,l=s.defaults.keys,t||l)&&(a=e.extend({},l,t),!1!==t)&&new i(n,a)})),s}));