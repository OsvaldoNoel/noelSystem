import Utils from"../../../utils/Utils";import Graphics from"../../../modules/Graphics";import DataLabels from"../../../modules/DataLabels";export default class TreemapHelpers{constructor(e){this.ctx=e,this.w=e.w}checkColorRange(){const e=this.w;let o=!1,t=e.config.plotOptions[e.config.chart.type];return t.colorScale.ranges.length>0&&t.colorScale.ranges.map(((e,t)=>{e.from<=0&&(o=!0)})),o}getShadeColor(e,o,t,l){const a=this.w;let s=1,r=a.config.plotOptions[e].shadeIntensity;const n=this.determineColor(e,o,t);a.globals.hasNegs||l?s=a.config.plotOptions[e].reverseNegativeShade?n.percent<0?n.percent/100*(1.25*r):(1-n.percent/100)*(1.25*r):n.percent<=0?1-(1+n.percent/100)*r:(1-n.percent/100)*r:(s=1-n.percent/100,"treemap"===e&&(s=(1-n.percent/100)*(1.25*r)));let i=n.color,c=new Utils;return a.config.plotOptions[e].enableShades&&(i="dark"===this.w.config.theme.mode?Utils.hexToRgba(c.shadeColor(-1*s,n.color),a.config.fill.opacity):Utils.hexToRgba(c.shadeColor(s,n.color),a.config.fill.opacity)),{color:i,colorProps:n}}determineColor(e,o,t){const l=this.w;let a=l.globals.series[o][t],s=l.config.plotOptions[e],r=s.colorScale.inverse?t:o;s.distributed&&"treemap"===l.config.chart.type&&(r=t);let n=l.globals.colors[r],i=null,c=Math.min(...l.globals.series[o]),p=Math.max(...l.globals.series[o]);s.distributed||"heatmap"!==e||(c=l.globals.minY,p=l.globals.maxY),void 0!==s.colorScale.min&&(c=s.colorScale.min<l.globals.minY?s.colorScale.min:l.globals.minY,p=s.colorScale.max>l.globals.maxY?s.colorScale.max:l.globals.maxY);let h=Math.abs(p)+Math.abs(c),d=100*a/(0===h?h-1e-6:h);if(s.colorScale.ranges.length>0){s.colorScale.ranges.map(((e,o)=>{if(a>=e.from&&a<=e.to){n=e.color,i=e.foreColor?e.foreColor:null,c=e.from,p=e.to;let o=Math.abs(p)+Math.abs(c);d=100*a/(0===o?o-1e-6:o)}}))}return{color:n,foreColor:i,percent:d}}calculateDataLabels({text:e,x:o,y:t,i:l,j:a,colorProps:s,fontSize:r}){let n=this.w.config.dataLabels;const i=new Graphics(this.ctx);let c=new DataLabels(this.ctx),p=null;if(n.enabled){p=i.group({class:"apexcharts-data-labels"});const h=n.offsetX,d=n.offsetY;let m=o+h,g=t+parseFloat(n.style.fontSize)/3+d;c.plotDataLabelsText({x:m,y:g,text:e,i:l,j:a,color:s.foreColor,parent:p,fontSize:r,dataLabelsConfig:n})}return p}addListeners(e){const o=new Graphics(this.ctx);e.node.addEventListener("mouseenter",o.pathMouseEnter.bind(this,e)),e.node.addEventListener("mouseleave",o.pathMouseLeave.bind(this,e)),e.node.addEventListener("mousedown",o.pathMouseDown.bind(this,e))}}