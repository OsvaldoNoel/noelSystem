import Utils from"../../utils/Utils";import Helpers from"./Helpers";export default class PointAnnotations{constructor(t){this.w=t.w,this.annoCtx=t,this.helpers=new Helpers(this.annoCtx)}addPointAnnotation(t,e,s){if(this.w.globals.collapsedSeriesIndices.indexOf(t.seriesIndex)>-1)return;let a=this.helpers.getX1X2("x1",t),o=a.x,i=a.clipped;a=this.helpers.getY1Y2("y1",t);let n=a.yP,r=a.clipped;if(Utils.isNumber(o)&&!r&&!i){let a={pSize:t.marker.size,pointStrokeWidth:t.marker.strokeWidth,pointFillColor:t.marker.fillColor,pointStrokeColor:t.marker.strokeColor,shape:t.marker.shape,pRadius:t.marker.radius,class:`apexcharts-point-annotation-marker ${t.marker.cssClass} ${t.id?t.id:""}`},i=this.annoCtx.graphics.drawMarker(o+t.marker.offsetX,n+t.marker.offsetY,a);e.appendChild(i.node);const r=t.label.text?t.label.text:"";let l=this.annoCtx.graphics.drawText({x:o+t.label.offsetX,y:n+t.label.offsetY-t.marker.size-parseFloat(t.label.style.fontSize)/1.6,text:r,textAnchor:t.label.textAnchor,fontSize:t.label.style.fontSize,fontFamily:t.label.style.fontFamily,fontWeight:t.label.style.fontWeight,foreColor:t.label.style.color,cssClass:`apexcharts-point-annotation-label ${t.label.style.cssClass} ${t.id?t.id:""}`});if(l.attr({rel:s}),e.appendChild(l.node),t.customSVG.SVG){let s=this.annoCtx.graphics.group({class:"apexcharts-point-annotations-custom-svg "+t.customSVG.cssClass});s.attr({transform:`translate(${o+t.customSVG.offsetX}, ${n+t.customSVG.offsetY})`}),s.node.innerHTML=t.customSVG.SVG,e.appendChild(s.node)}if(t.image.path){let e=t.image.width?t.image.width:20,s=t.image.height?t.image.height:20;i=this.annoCtx.addImage({x:o+t.image.offsetX-e/2,y:n+t.image.offsetY-s/2,width:e,height:s,path:t.image.path,appendTo:".apexcharts-point-annotations"})}t.mouseEnter&&i.node.addEventListener("mouseenter",t.mouseEnter.bind(this,t)),t.mouseLeave&&i.node.addEventListener("mouseleave",t.mouseLeave.bind(this,t)),t.click&&i.node.addEventListener("click",t.click.bind(this,t))}}drawPointAnnotations(){let t=this.w,e=this.annoCtx.graphics.group({class:"apexcharts-point-annotations"});return t.config.annotations.points.map(((t,s)=>{this.addPointAnnotation(t,e.node,s)})),e}}