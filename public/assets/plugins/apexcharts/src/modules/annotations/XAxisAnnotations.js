import Utils from"../../utils/Utils";import Helpers from"./Helpers";export default class XAnnotations{constructor(t){this.w=t.w,this.annoCtx=t,this.invertAxis=this.annoCtx.invertAxis,this.helpers=new Helpers(this.annoCtx)}addXaxisAnnotation(t,e,i){let s,l=this.w,o=this.helpers.getX1X2("x1",t),a=o.x,n=o.clipped,r=!0;const d=t.label.text;let h=t.strokeDashArray;if(Utils.isNumber(a)){if(null===t.x2||void 0===t.x2){if(!n){let i=this.annoCtx.graphics.drawLine(a+t.offsetX,0+t.offsetY,a+t.offsetX,l.globals.gridHeight+t.offsetY,t.borderColor,h,t.borderWidth);e.appendChild(i.node),t.id&&i.node.classList.add(t.id)}}else{let i=this.helpers.getX1X2("x2",t);if(s=i.x,r=i.clipped,!n||!r){if(s<a){let t=a;a=s,s=t}let i=this.annoCtx.graphics.drawRect(a+t.offsetX,0+t.offsetY,s-a,l.globals.gridHeight+t.offsetY,0,t.fillColor,t.opacity,1,t.borderColor,h);i.node.classList.add("apexcharts-annotation-rect"),i.attr("clip-path",`url(#gridRectMask${l.globals.cuid})`),e.appendChild(i.node),t.id&&i.node.classList.add(t.id)}}if(!n||!r){let s=this.annoCtx.graphics.getTextRects(d,parseFloat(t.label.style.fontSize)),o="top"===t.label.position?4:"center"===t.label.position?l.globals.gridHeight/2+("vertical"===t.label.orientation?s.width/2:0):l.globals.gridHeight,n=this.annoCtx.graphics.drawText({x:a+t.label.offsetX,y:o+t.label.offsetY-("vertical"===t.label.orientation?"top"===t.label.position?s.width/2-12:-s.width/2:0),text:d,textAnchor:t.label.textAnchor,fontSize:t.label.style.fontSize,fontFamily:t.label.style.fontFamily,fontWeight:t.label.style.fontWeight,foreColor:t.label.style.color,cssClass:`apexcharts-xaxis-annotation-label ${t.label.style.cssClass} ${t.id?t.id:""}`});n.attr({rel:i}),e.appendChild(n.node),this.annoCtx.helpers.setOrientations(t,i)}}}drawXAxisAnnotations(){let t=this.w,e=this.annoCtx.graphics.group({class:"apexcharts-xaxis-annotations"});return t.config.annotations.xaxis.map(((t,i)=>{this.addXaxisAnnotation(t,e.node,i)})),e}}