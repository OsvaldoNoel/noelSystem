import Utils from"./../utils/Utils";class Filters{constructor(e){this.ctx=e,this.w=e.w}getDefaultFilter(e,t){const i=this.w;e.unfilter(!0),(new window.SVG.Filter).size("120%","180%","-5%","-40%"),"none"!==i.config.states.normal.filter?this.applyFilter(e,t,i.config.states.normal.filter.type,i.config.states.normal.filter.value):i.config.chart.dropShadow.enabled&&this.dropShadow(e,i.config.chart.dropShadow,t)}addNormalFilter(e,t){const i=this.w;i.config.chart.dropShadow.enabled&&!e.node.classList.contains("apexcharts-marker")&&this.dropShadow(e,i.config.chart.dropShadow,t)}addLightenFilter(e,t,i){const r=this.w,{intensity:s}=i;e.unfilter(!0);let o=new window.SVG.Filter;e.filter((e=>{const i=r.config.chart.dropShadow;o=i.enabled?this.addShadow(e,t,i):e,o.componentTransfer({rgb:{type:"linear",slope:1.5,intercept:s}})})),e.filterer.node.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(e.filterer.node)}addDarkenFilter(e,t,i){const r=this.w,{intensity:s}=i;e.unfilter(!0);let o=new window.SVG.Filter;e.filter((e=>{const i=r.config.chart.dropShadow;o=i.enabled?this.addShadow(e,t,i):e,o.componentTransfer({rgb:{type:"linear",slope:s}})})),e.filterer.node.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(e.filterer.node)}applyFilter(e,t,i,r=.5){switch(i){case"none":this.addNormalFilter(e,t);break;case"lighten":this.addLightenFilter(e,t,{intensity:r});break;case"darken":this.addDarkenFilter(e,t,{intensity:r})}}addShadow(e,t,i){const r=this.w,{blur:s,top:o,left:n,color:l,opacity:a}=i;if(r.config.chart.dropShadow.enabledOnSeries?.length>0&&-1===r.config.chart.dropShadow.enabledOnSeries.indexOf(t))return e;let d=e.flood(Array.isArray(l)?l[t]:l,a).composite(e.sourceAlpha,"in").offset(n,o).gaussianBlur(s).merge(e.source);return e.blend(e.source,d)}dropShadow(e,t,i=0){let{top:r,left:s,blur:o,color:n,opacity:l,noUserSpaceOnUse:a}=t;const d=this.w;return e.unfilter(!0),Utils.isIE()&&"radialBar"===d.config.chart.type||d.config.chart.dropShadow.enabledOnSeries?.length>0&&-1===d.config.chart.dropShadow.enabledOnSeries?.indexOf(i)||(n=Array.isArray(n)?n[i]:n,e.filter((e=>{let t=null;t=Utils.isSafari()||Utils.isFirefox()||Utils.isIE()?e.flood(n,l).composite(e.sourceAlpha,"in").offset(s,r).gaussianBlur(o):e.flood(n,l).composite(e.sourceAlpha,"in").offset(s,r).gaussianBlur(o).merge(e.source),e.blend(e.source,t)})),a||e.filterer.node.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(e.filterer.node)),e}setSelectionFilter(e,t,i){const r=this.w;if(void 0!==r.globals.selectedDataPoints[t]&&r.globals.selectedDataPoints[t].indexOf(i)>-1){e.node.setAttribute("selected",!0);let i=r.config.states.active.filter;"none"!==i&&this.applyFilter(e,t,i.type,i.value)}}_scaleFilterSize(e){(t=>{for(let i in t)t.hasOwnProperty(i)&&e.setAttribute(i,t[i])})({width:"200%",height:"200%",x:"-50%",y:"-50%"})}}export default Filters;