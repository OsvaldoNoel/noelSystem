import Utilities from"../../utils/Utils";export default class Utils{constructor(e){this.w=e.w,this.ttCtx=e,this.ctx=e.ctx}getNearestValues({hoverArea:e,elGrid:t,clientX:s,clientY:l}){let r=this.w;const a=t.getBoundingClientRect(),i=a.width,o=a.height;let n=i/(r.globals.dataPoints-1),h=o/r.globals.dataPoints;const c=this.hasBars();!r.globals.comboCharts&&!c||r.config.xaxis.convertedCatToNumeric||(n=i/r.globals.dataPoints);let g=s-a.left-r.globals.barPadForNumericAxis,u=l-a.top;g<0||u<0||g>i||u>o?(e.classList.remove("hovering-zoom"),e.classList.remove("hovering-pan")):r.globals.zoomEnabled?(e.classList.remove("hovering-pan"),e.classList.add("hovering-zoom")):r.globals.panEnabled&&(e.classList.remove("hovering-zoom"),e.classList.add("hovering-pan"));let d=Math.round(g/n),b=Math.floor(u/h);c&&!r.config.xaxis.convertedCatToNumeric&&(d=Math.ceil(g/n),d-=1);let p=null,m=null,x=r.globals.seriesXvalues.map((e=>e.filter((e=>Utilities.isNumber(e))))),v=r.globals.seriesYvalues.map((e=>e.filter((e=>Utilities.isNumber(e)))));if(r.globals.isXNumeric){const e=this.ttCtx.getElGrid().getBoundingClientRect(),t=g*(e.width/i),s=u*(e.height/o);m=this.closestInMultiArray(t,s,x,v),p=m.index,d=m.j,null!==p&&(x=r.globals.seriesXvalues[p],m=this.closestInArray(t,x),d=m.index)}return r.globals.capturedSeriesIndex=null===p?-1:p,(!d||d<1)&&(d=0),r.globals.isBarHorizontal?r.globals.capturedDataPointIndex=b:r.globals.capturedDataPointIndex=d,{capturedSeries:p,j:r.globals.isBarHorizontal?b:d,hoverX:g,hoverY:u}}closestInMultiArray(e,t,s,l){let r=this.w,a=0,i=null,o=-1;r.globals.series.length>1?a=this.getFirstActiveXArray(s):i=0;let n=s[a][0],h=Math.abs(e-n);if(s.forEach((t=>{t.forEach(((t,s)=>{const l=Math.abs(e-t);l<=h&&(h=l,o=s)}))})),-1!==o){let e=l[a][o],s=Math.abs(t-e);i=a,l.forEach(((e,l)=>{const r=Math.abs(t-e[o]);r<=s&&(s=r,i=l)}))}return{index:i,j:o}}getFirstActiveXArray(e){const t=this.w;let s=0,l=e.map(((e,t)=>e.length>0?t:-1));for(let e=0;e<l.length;e++)if(-1!==l[e]&&-1===t.globals.collapsedSeriesIndices.indexOf(e)&&-1===t.globals.ancillaryCollapsedSeriesIndices.indexOf(e)){s=l[e];break}return s}closestInArray(e,t){let s=t[0],l=null,r=Math.abs(e-s);for(let s=0;s<t.length;s++){let a=Math.abs(e-t[s]);a<r&&(r=a,l=s)}return{index:l}}isXoverlap(e){let t=[];const s=this.w.globals.seriesX.filter((e=>void 0!==e[0]));if(s.length>0)for(let l=0;l<s.length-1;l++)void 0!==s[l][e]&&void 0!==s[l+1][e]&&s[l][e]!==s[l+1][e]&&t.push("unEqual");return 0===t.length}isInitialSeriesSameLen(){let e=!0;const t=this.w.globals.initialSeries;for(let s=0;s<t.length-1;s++)if(t[s].data.length!==t[s+1].data.length){e=!1;break}return e}getBarsHeight(e){return[...e].reduce(((e,t)=>e+t.getBBox().height),0)}getElMarkers(e){return"number"==typeof e?this.w.globals.dom.baseEl.querySelectorAll(`.apexcharts-series[data\\:realIndex='${e}'] .apexcharts-series-markers-wrap > *`):this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers-wrap > *")}getAllMarkers(){let e=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers-wrap");e=[...e],e.sort(((e,t)=>{var s=Number(e.getAttribute("data:realIndex")),l=Number(t.getAttribute("data:realIndex"));return l<s?1:l>s?-1:0}));let t=[];return e.forEach((e=>{t.push(e.querySelector(".apexcharts-marker"))})),t}hasMarkers(e){return this.getElMarkers(e).length>0}getElBars(){return this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-bar-series,  .apexcharts-candlestick-series, .apexcharts-boxPlot-series, .apexcharts-rangebar-series")}hasBars(){return this.getElBars().length>0}getHoverMarkerSize(e){const t=this.w;let s=t.config.markers.hover.size;return void 0===s&&(s=t.globals.markers.size[e]+t.config.markers.hover.sizeOffset),s}toggleAllTooltipSeriesGroups(e){let t=this.w;const s=this.ttCtx;0===s.allTooltipSeriesGroups.length&&(s.allTooltipSeriesGroups=t.globals.dom.baseEl.querySelectorAll(".apexcharts-tooltip-series-group"));let l=s.allTooltipSeriesGroups;for(let s=0;s<l.length;s++)"enable"===e?(l[s].classList.add("apexcharts-active"),l[s].style.display=t.config.tooltip.items.display):(l[s].classList.remove("apexcharts-active"),l[s].style.display="none")}}