import Utils from"../utils/Utils";export default class Events{constructor(e){this.ctx=e,this.w=e.w,this.documentEvent=Utils.bind(this.documentEvent,this)}addEventListener(e,t){const s=this.w;s.globals.events.hasOwnProperty(e)?s.globals.events[e].push(t):s.globals.events[e]=[t]}removeEventListener(e,t){const s=this.w;if(!s.globals.events.hasOwnProperty(e))return;let n=s.globals.events[e].indexOf(t);-1!==n&&s.globals.events[e].splice(n,1)}fireEvent(e,t){const s=this.w;if(!s.globals.events.hasOwnProperty(e))return;t&&t.length||(t=[]);let n=s.globals.events[e],o=n.length;for(let e=0;e<o;e++)n[e].apply(null,t)}setupEventHandlers(){const e=this.w,t=this.ctx;let s=e.globals.dom.baseEl.querySelector(e.globals.chartClass);this.ctx.eventList.forEach((n=>{s.addEventListener(n,(s=>{const n=Object.assign({},e,{seriesIndex:e.globals.axisCharts?e.globals.capturedSeriesIndex:0,dataPointIndex:e.globals.capturedDataPointIndex});"mousemove"===s.type||"touchmove"===s.type?"function"==typeof e.config.chart.events.mouseMove&&e.config.chart.events.mouseMove(s,t,n):"mouseleave"===s.type||"touchleave"===s.type?"function"==typeof e.config.chart.events.mouseLeave&&e.config.chart.events.mouseLeave(s,t,n):("mouseup"===s.type&&1===s.which||"touchend"===s.type)&&("function"==typeof e.config.chart.events.click&&e.config.chart.events.click(s,t,n),t.ctx.events.fireEvent("click",[s,t,n]))}),{capture:!1,passive:!0})})),this.ctx.eventList.forEach((t=>{e.globals.dom.baseEl.addEventListener(t,this.documentEvent,{passive:!0})})),this.ctx.core.setupBrushHandler()}documentEvent(e){const t=this.w,s=e.target.className;if("click"===e.type){let e=t.globals.dom.baseEl.querySelector(".apexcharts-menu");e&&e.classList.contains("apexcharts-menu-open")&&"apexcharts-menu-icon"!==s&&e.classList.remove("apexcharts-menu-open")}t.globals.clientX="touchmove"===e.type?e.touches[0].clientX:e.clientX,t.globals.clientY="touchmove"===e.type?e.touches[0].clientY:e.clientY}}