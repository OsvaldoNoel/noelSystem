const Utils=$.fn.bootstrapTable.utils;Object.assign($.fn.bootstrapTable.defaults,{usePipeline:!1,pipelineSize:1e3,onCachedDataHit:e=>!1,onCachedDataReset:e=>!1}),Object.assign($.fn.bootstrapTable.events,{"cached-data-hit.bs.table":"onCachedDataHit","cached-data-reset.bs.table":"onCachedDataReset"}),$.BootstrapTable=class extends $.BootstrapTable{init(...e){this.options.usePipeline&&this.initPipeline(),super.init(...e)}initPipeline(){this.cacheRequestJSON={},this.cacheWindows=[],this.currWindow=0,this.resetCache=!0}onSearch(...e){this.options.usePipeline&&(this.resetCache=!0),super.onSearch(...e)}onSort(...e){this.options.usePipeline&&(this.resetCache=!0),super.onSort(...e)}onPageListChange(e){const i=$(e.currentTarget),t=parseInt(i.text(),10);this.options.pipelineSize=this.calculatePipelineSize(this.options.pipelineSize,t),this.resetCache=!0,super.onPageListChange(e)}calculatePipelineSize(e,i){return 0===i?0:Math.ceil(e/i)*i}setCacheWindows(){this.cacheWindows=[];for(let e=0;e<=this.options.totalRows/this.options.pipelineSize;e++){const i=e*this.options.pipelineSize;this.cacheWindows[e]={lower:i,upper:i+this.options.pipelineSize-1}}}setCurrWindow(e){this.currWindow=0;for(let i=0;i<this.cacheWindows.length;i++)if(this.cacheWindows[i].lower<=e&&e<=this.cacheWindows[i].upper){this.currWindow=i;break}}drawFromCache(e,i){const t=Utils.extend(!0,{},this.cacheRequestJSON),s=e-this.cacheWindows[this.currWindow].lower,o=s+i;return t.rows=t.rows.slice(s,o),t}initServer(e,i,t){if(!this.options.usePipeline)return super.initServer(e,i,t);let s=!0;const o={};if("limit"===this.options.queryParamsType&&this.options.pagination&&"server"===this.options.sidePagination)if(o.offset=this.options.pageSize===this.options.formatAllRows()?0:this.options.pageSize*(this.options.pageNumber-1),o.limit=this.options.pageSize,this.cacheWindows.length){const e=this.cacheWindows[this.currWindow];this.resetCache||o.offset<e.lower||o.offset>e.upper?(s=!0,this.setCurrWindow(o.offset),o.drawOffset=o.offset,o.offset=this.cacheWindows[this.currWindow].lower):s=!1}else s=!0,o.drawOffset=o.offset;if(this.resetCache&&(s=!0,this.resetCache=!1),s&&(o.drawLimit=o.limit,o.limit=this.options.pipelineSize),!s){const e=this.drawFromCache(o.offset,o.limit);return this.load(e),this.trigger("load-success",e),void this.trigger("cached-data-hit",e)}return this.pipelineResponseHandler||(this.pipelineResponseHandler=this.options.responseHandler,this.options.responseHandler=(e,i)=>{let t=Utils.calculateObjectValue(this.options,this.pipelineResponseHandler,[e,i],e);return this.cacheRequestJSON=Utils.extend(!0,{},t),this.options.totalRows=t[this.options.totalField],this.setCacheWindows(),t=this.drawFromCache(o.drawOffset,o.drawLimit),this.trigger("cached-data-reset",t),t}),super.initServer(e,{...i,...o},t)}destroy(...e){this.options.responseHandler=this.pipelineResponseHandler,this.pipelineResponseHandler=null,super.destroy(...e)}};