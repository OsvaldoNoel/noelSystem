const Utils=$.fn.bootstrapTable.utils,searchControls='select, input:not([type="checkbox"]):not([type="radio"])';export function getInputClass(t,e=!1){const o=e?t.constants.classes.select:t.constants.classes.input;return t.options.iconSize?Utils.sprintf("%s %s-%s",o,o,t.options.iconSize):o}export function getOptionsFromSelectControl(t){return t[0].options}export function getControlContainer(t){return t.options.filterControlContainer?$(`${t.options.filterControlContainer}`):t.options.height&&t._initialized?t.$tableContainer.find(".fixed-table-header table thead"):t.$header}export function isKeyAllowed(t){return $.inArray(t,[37,38,39,40])>-1}export function getSearchControls(t){return getControlContainer(t).find(searchControls)}export function hideUnusedSelectOptions(t,e){const o=getOptionsFromSelectControl(t);for(let n=0;n<o.length;n++)""!==o[n].value&&(e.hasOwnProperty(o[n].value)?t.find(Utils.sprintf("option[value='%s']",o[n].value)).show():t.find(Utils.sprintf("option[value='%s']",o[n].value)).hide())}export function existOptionInSelectControl(t,e){const o=getOptionsFromSelectControl(t);for(let t=0;t<o.length;t++)if(o[t].value===Utils.unescapeHTML(e))return!0;return!1}export function addOptionToSelectControl(t,e,o,n,r){let l=null==e?"":e.toString().trim();if(l=Utils.removeHTML(Utils.unescapeHTML(l)),o=Utils.removeHTML(Utils.unescapeHTML(o)),existOptionInSelectControl(t,l))return;const i=new Option(o,l,!1,r?l===n||o===n:l===n);t.get(0).add(i)}export function sortSelectControl(t,e,o){const n=t.get(0);if("server"===e)return;const r=new Array;for(let t=0;t<n.options.length;t++)r[t]=new Array,r[t][0]=n.options[t].text,r[t][1]=n.options[t].value,r[t][2]=n.options[t].selected;for(r.sort(((t,n)=>Utils.sort(t[0],n[0],"desc"===e?-1:1,o)));n.options.length>0;)n.options[0]=null;for(let t=0;t<r.length;t++){const e=new Option(r[t][0],r[t][1],!1,r[t][2]);n.add(e)}}export function fixHeaderCSS({$tableHeader:t}){t.css("height",t.find("table").outerHeight(!0))}export function getElementClass(t){return t.attr("class").split(" ").filter((function(t){return t.startsWith("bootstrap-table-filter-control-")}))}export function getCursorPosition(t){if($(t).is("input[type=search]")){let e=0;if("selectionStart"in t)e=t.selectionStart;else if("selection"in document){t.focus();const o=document.selection.createRange(),n=document.selection.createRange().text.length;o.moveStart("character",-t.value.length),e=o.text.length-n}return e}return-1}export function cacheValues(t){const e=getSearchControls(t);t._valuesFilterControl=[],e.each((function(){let e=$(this);const o=escapeID(getElementClass(e));e=t.options.height&&!t.options.filterControlContainer?t.$el.find(`.fixed-table-header .${o}`):t.options.filterControlContainer?$(`${t.options.filterControlContainer} .${o}`):t.$el.find(`.${o}`),t._valuesFilterControl.push({field:e.closest("[data-field]").data("field"),value:e.val(),position:getCursorPosition(e.get(0)),hasFocus:e.is(":focus")})}))}export function setCaretPosition(t,e){try{if(t)if(t.createTextRange){const o=t.createTextRange();o.move("character",e),o.select()}else t.setSelectionRange(e,e)}catch(t){}}export function setValues(t){let e=null,o=[];const n=getSearchControls(t);if(t._valuesFilterControl.length>0){const r=[];n.each(((n,l)=>{const i=$(l);if(e=i.closest("[data-field]").data("field"),o=t._valuesFilterControl.filter((t=>t.field===e)),o.length>0&&(o[0].hasFocus||o[0].value)){const t=(a=i.get(0),s=o[0],()=>{if(s.hasFocus&&a.focus(),Array.isArray(s.value)){const t=$(a);$.each(s.value,(function(e,o){t.find(Utils.sprintf("option[value='%s']",o)).prop("selected",!0)}))}else a.value=s.value;setCaretPosition(a,s.position)});r.push(t)}var a,s})),r.length>0&&r.forEach((t=>t()))}}export function collectBootstrapTableFilterCookies(){const t=[],e=document.cookie.match(/bs\.table\.(filterControl|searchText)/g),o=localStorage;if(e&&$.each(e,((e,o)=>{let n=o;/./.test(n)&&(n=n.split(".").pop()),-1===$.inArray(n,t)&&t.push(n)})),o)for(let e=0;e<o.length;e++){let n=o.key(e);/./.test(n)&&(n=n.split(".").pop()),t.includes(n)||t.push(n)}return t}export function escapeID(t){return String(t).replace(/([:.\[\],])/g,"\\$1")}export function isColumnSearchableViaSelect({filterControl:t,searchable:e}){return t&&"select"===t.toLowerCase()&&e}export function isFilterDataNotGiven({filterData:t}){return void 0===t||"column"===t.toLowerCase()}export function hasSelectControlElement(t){return t&&t.length>0}export function initFilterSelectControls(t){const e=t.options.data;$.each(t.header.fields,((o,n)=>{const r=t.columns[t.fieldsColumnsIndex[n]],l=getControlContainer(t).find(`select.bootstrap-table-filter-control-${escapeID(r.field)}`);if(isColumnSearchableViaSelect(r)&&isFilterDataNotGiven(r)&&hasSelectControlElement(l)){l[0].multiple||0!==l.get(l.length-1).options.length||addOptionToSelectControl(l,"",r.filterControlPlaceholder||" ",r.filterDefault);const i={};for(let a=0;a<e.length;a++){let s=Utils.getItemField(e[a],n,!1);const c=t.options.editable&&r.editable?r._formatter:t.header.formatters[o];let f=Utils.calculateObjectValue(t.header,c,[s,e[a],a],s);null==s&&(s=f,r._forceFormatter=!0),r.filterDataCollector&&(f=Utils.calculateObjectValue(t.header,r.filterDataCollector,[s,e[a],f],f)),r.searchFormatter&&(s=f),i[f]=s,"object"!=typeof f||null===f||f.forEach((t=>{addOptionToSelectControl(l,t,t,r.filterDefault)}))}for(const t in i)addOptionToSelectControl(l,i[t],t,r.filterDefault);t.options.sortSelectOptions&&sortSelectControl(l,r.filterOrderBy,t.options)}}))}export function getFilterDataMethod(t,e){const o=Object.keys(t);for(let n=0;n<o.length;n++)if(o[n]===e)return t[e];return null}export function createControls(t,e){let o,n=!1;$.each(t.columns,((r,l)=>{if(o=[],l.visible||t.options.filterControlContainer&&$(`.bootstrap-table-filter-control-${escapeID(l.field)}`).length>=1){if(l.filterControl||t.options.filterControlContainer)if(t.options.filterControlContainer){const t=$(`.bootstrap-table-filter-control-${escapeID(l.field)}`);$.each(t,((t,e)=>{const o=$(e);if(!o.is("[type=radio]")){const t=l.filterControlPlaceholder||"";o.attr("placeholder",t).val(l.filterDefault)}o.attr("data-field",l.field)})),n=!0}else{const e=l.filterControl.toLowerCase();o.push('<div class="filter-control">'),n=!0,l.searchable&&t.options.filterTemplate[e]&&o.push(t.options.filterTemplate[e](t,l,l.filterControlPlaceholder?l.filterControlPlaceholder:"",l.filterDefault))}else o.push('<div class="no-filter-control"></div>');if(l.filterControl&&""!==l.filterDefault&&void 0!==l.filterDefault&&($.isEmptyObject(t.filterColumnsPartial)&&(t.filterColumnsPartial={}),l.field in t.filterColumnsPartial||(t.filterColumnsPartial[l.field]=l.filterDefault)),$.each(e.find("th"),((t,e)=>{const n=$(e);if(n.data("field")===l.field)return n.find(".filter-control").remove(),n.find(".fht-cell").html(o.join("")),!1})),l.filterData&&"column"!==l.filterData.toLowerCase()){const o=getFilterDataMethod(filterDataMethods,l.filterData.substring(0,l.filterData.indexOf(":")));let n,r;if(!o)throw new SyntaxError('Error. You should use any of these allowed filter data methods: var, obj, json, url, func. Use like this: var: {key: "value"}');n=l.filterData.substring(l.filterData.indexOf(":")+1,l.filterData.length),r=e.find(`.bootstrap-table-filter-control-${escapeID(l.field)}`),addOptionToSelectControl(r,"",l.filterControlPlaceholder,l.filterDefault,!0),o(t,n,r,t.options.filterOrderBy,l.filterDefault)}}})),n?(e.off("keyup","input").on("keyup","input",(({currentTarget:e,keyCode:o},n)=>{if(o=n?n.keyCode:o,t.options.searchOnEnterKey&&13!==o)return;if(isKeyAllowed(o))return;const r=$(e);r.is(":checkbox")||r.is(":radio")||(clearTimeout(e.timeoutId||0),e.timeoutId=setTimeout((()=>{t.onColumnSearch({currentTarget:e,keyCode:o})}),t.options.searchTimeOut))})),e.off("change","select",".fc-multipleselect").on("change","select",".fc-multipleselect",(({currentTarget:e,keyCode:o})=>{const n=$(e),r=n.val();if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]&&r[t].length>0&&r[t].trim()&&n.find(`option[value="${r[t]}"]`).attr("selected",!0);else r&&r.length>0&&r.trim()?(n.find("option[selected]").removeAttr("selected"),n.find(`option[value="${r}"]`).attr("selected",!0)):n.find("option[selected]").removeAttr("selected");clearTimeout(e.timeoutId||0),e.timeoutId=setTimeout((()=>{t.onColumnSearch({currentTarget:e,keyCode:o})}),t.options.searchTimeOut)})),e.off("mouseup","input:not([type=radio])").on("mouseup","input:not([type=radio])",(({currentTarget:e,keyCode:o})=>{const n=$(e);""!==n.val()&&setTimeout((()=>{""===n.val()&&(clearTimeout(e.timeoutId||0),e.timeoutId=setTimeout((()=>{t.onColumnSearch({currentTarget:e,keyCode:o})}),t.options.searchTimeOut))}),1)})),e.off("change","input[type=radio]").on("change","input[type=radio]",(({currentTarget:e,keyCode:o})=>{clearTimeout(e.timeoutId||0),e.timeoutId=setTimeout((()=>{t.onColumnSearch({currentTarget:e,keyCode:o})}),t.options.searchTimeOut)})),e.find(".date-filter-control").length>0&&$.each(t.columns,((o,{filterDefault:n,filterControl:r,field:l,filterDatepickerOptions:i})=>{if(void 0!==r&&"datepicker"===r.toLowerCase()){const o=e.find(`.date-filter-control.bootstrap-table-filter-control-${escapeID(l)}`);n&&o.value(n),i.min&&o.attr("min",i.min),i.max&&o.attr("max",i.max),i.step&&o.attr("step",i.step),i.pattern&&o.attr("pattern",i.pattern),o.on("change",(({currentTarget:e})=>{clearTimeout(e.timeoutId||0),e.timeoutId=setTimeout((()=>{t.onColumnSearch({currentTarget:e})}),t.options.searchTimeOut)}))}})),"server"!==t.options.sidePagination&&t.triggerSearch(),t.options.filterControlVisible||e.find(".filter-control, .no-filter-control").hide()):e.find(".filter-control, .no-filter-control").hide(),t.trigger("created-controls")}export function getDirectionOfSelectOptions(t){switch(void 0===t?"left":t.toLowerCase()){case"left":default:return"ltr";case"right":return"rtl";case"auto":return"auto"}}export function syncHeaders(t){if(!t.options.height)return;0!==t.$tableContainer.find(".fixed-table-header table thead").length&&t.$header.children().find("th[data-field]").each(((e,o)=>{if("bs-checkbox"!==o.classList[0]){const e=$(o),n=e.data("field"),r=t.$tableContainer.find(`th[data-field='${n}']`).not(e),l=e.find("input"),i=r.find("input");l.length>0&&i.length>0&&l.val()!==i.val()&&l.val(i.val())}}))}const filterDataMethods={func(t,e,o,n,r){const l=window[e].apply();for(const t in l)addOptionToSelectControl(o,t,l[t],r);t.options.sortSelectOptions&&sortSelectControl(o,n,t.options),setValues(t)},obj(t,e,o,n,r){const l=e.split("."),i=l.shift();let a=window[i];l.length>0&&l.forEach((t=>{a=a[t]}));for(const t in a)addOptionToSelectControl(o,t,a[t],r);t.options.sortSelectOptions&&sortSelectControl(o,n,t.options),setValues(t)},var(t,e,o,n,r){const l=window[e],i=Array.isArray(l);for(const t in l)addOptionToSelectControl(o,i?l[t]:t,l[t],r,!0);t.options.sortSelectOptions&&sortSelectControl(o,n,t.options),setValues(t)},url(t,e,o,n,r){$.ajax({url:e,dataType:"json",success(e){for(const t in e)addOptionToSelectControl(o,t,e[t],r);t.options.sortSelectOptions&&sortSelectControl(o,n,t.options),setValues(t)}})},json(t,e,o,n,r){const l=JSON.parse(e);for(const t in l)addOptionToSelectControl(o,t,l[t],r);t.options.sortSelectOptions&&sortSelectControl(o,n,t.options),setValues(t)}};