/*! For license information please see dataTables.fixedHeader.min.mjs.LICENSE.txt */
import t from"jquery";import e from"datatables.net";let o=t;var i=0,s=function(t,d){if(!e.versionCheck("2"))throw"Warning: FixedHeader requires DataTables 2 or newer";if(!(this instanceof s))throw"FixedHeader must be initialised with the 'new' keyword.";if(!0===d&&(d={}),t=new e.Api(t),this.c=o.extend(!0,{},s.defaults,d),this.s={dt:t,position:{theadTop:0,tbodyTop:0,tfootTop:0,tfootBottom:0,width:0,left:0,tfootHeight:0,theadHeight:0,windowHeight:o(window).height(),visible:!0},headerMode:null,footerMode:null,autoWidth:t.settings()[0].oFeatures.bAutoWidth,namespace:".dtfc"+i++,scrollLeft:{header:-1,footer:-1},enable:!0,autoDisable:!1},this.dom={floatingHeader:null,thead:o(t.table().header()),tbody:o(t.table().body()),tfoot:o(t.table().footer()),header:{host:null,floating:null,floatingParent:o('<div class="dtfh-floatingparent"><div></div></div>'),placeholder:null},footer:{host:null,floating:null,floatingParent:o('<div class="dtfh-floatingparent"><div></div></div>'),placeholder:null}},this.dom.header.host=this.dom.thead.parent(),this.dom.footer.host=this.dom.tfoot.parent(),(d=t.settings()[0])._fixedHeader)throw"FixedHeader already initialised on table "+d.nTable.id;(d._fixedHeader=this)._constructor()};o.extend(s.prototype,{destroy:function(){var t=this.dom;this.s.dt.off(".dtfc"),o(window).off(this.s.namespace),t.header.rightBlocker&&t.header.rightBlocker.remove(),t.header.leftBlocker&&t.header.leftBlocker.remove(),t.footer.rightBlocker&&t.footer.rightBlocker.remove(),t.footer.leftBlocker&&t.footer.leftBlocker.remove(),this.c.header&&this._modeChange("in-place","header",!0),this.c.footer&&t.tfoot.length&&this._modeChange("in-place","footer",!0)},enable:function(t,e,o){this.s.enable=t,this.s.enableType=o,!e&&void 0!==e||(this._positions(),this._scroll(!0))},enabled:function(){return this.s.enable},headerOffset:function(t){return void 0!==t&&(this.c.headerOffset=t,this.update()),this.c.headerOffset},footerOffset:function(t){return void 0!==t&&(this.c.footerOffset=t,this.update()),this.c.footerOffset},update:function(t){var e=this.s.dt.table().node();(this.s.enable||this.s.autoDisable)&&(o(e).is(":visible")?(this.s.autoDisable=!1,this.enable(!0,!1)):(this.s.autoDisable=!0,this.enable(!1,!1)),0!==o(e).children("thead").length)&&(this._positions(),this._scroll(void 0===t||t),this._widths(this.dom.header),this._widths(this.dom.footer))},_constructor:function(){var t=this,i=this.s.dt,s=(o(window).on("scroll"+this.s.namespace,(function(){t._scroll()})).on("resize"+this.s.namespace,e.util.throttle((function(){t.s.position.windowHeight=o(window).height(),t.update()}),50)),o(".fh-fixedHeader"));!this.c.headerOffset&&s.length&&(this.c.headerOffset=s.outerHeight()),s=o(".fh-fixedFooter");!this.c.footerOffset&&s.length&&(this.c.footerOffset=s.outerHeight()),i.on("column-reorder.dt.dtfc column-visibility.dt.dtfc column-sizing.dt.dtfc responsive-display.dt.dtfc",(function(e,o){t.update()})).on("draw.dt.dtfc",(function(e,o){t.update(o!==i.settings()[0])})),i.on("destroy.dtfc",(function(){t.destroy()})),this._positions(),this._scroll()},_clone:function(t,e){var i,s,d=this,r=this.s.dt,n=this.dom[t],a="header"===t?this.dom.thead:this.dom.tfoot;"footer"===t&&this._scrollEnabled()||(!e&&n.floating?n.floating.removeClass("fixedHeader-floating fixedHeader-locked"):(n.floating&&(null!==n.placeholder&&n.placeholder.remove(),n.floating.children().detach(),n.floating.remove()),e=o(r.table().node()),i=o(e.parent()),s=this._scrollEnabled(),n.floating=o(r.table().node().cloneNode(!1)).attr("aria-hidden","true").css({top:0,left:0}).removeAttr("id"),n.floatingParent.css({width:i[0].offsetWidth,overflow:"hidden",height:"fit-content",position:"fixed",left:s?e.offset().left+i.scrollLeft():0}).css("header"===t?{top:this.c.headerOffset,bottom:""}:{top:"",bottom:this.c.footerOffset}).addClass("footer"===t?"dtfh-floatingparent-foot":"dtfh-floatingparent-head").appendTo("body").children().eq(0).append(n.floating),this._stickyPosition(n.floating,"-"),(s=function(){var t=i.scrollLeft();d.s.scrollLeft={footer:t,header:t},n.floatingParent.scrollLeft(d.s.scrollLeft.header)})(),i.off("scroll.dtfh").on("scroll.dtfh",s),n.floatingParent.children().css({width:"fit-content",paddingRight:d.s.dt.settings()[0].oBrowser.barWidth}),(e=o("footer"===t?"div.dtfc-bottom-blocker":"div.dtfc-top-blocker",r.table().container())).length&&e.clone().appendTo(n.floatingParent).css({position:"fixed",right:e.width()}),n.placeholder=a.clone(!1),n.placeholder.find("*[id]").removeAttr("id"),n.host.prepend(n.placeholder),n.floating.append(a),this._widths(n)))},_stickyPosition:function(t,e){var i;this._scrollEnabled()&&(i="rtl"===o(this.s.dt.table().node()).css("direction"),t.find("th").each((function(){var t,e,s;"sticky"===o(this).css("position")&&(t=o(this).css("right"),e=o(this).css("left"),"auto"===t||i?"auto"!==e&&i&&(s=+e.replace(/px/g,""),o(this).css("left",0<s?s:0)):(s=+t.replace(/px/g,""),o(this).css("right",0<s?s:0)))})))},_horizontal:function(t,e){var i,s=this.dom[t],d=this.s.scrollLeft;s.floating&&d[t]!==e&&(this._scrollEnabled()&&(i=o(o(this.s.dt.table().node()).parent()).scrollLeft(),s.floating.scrollLeft(i),s.floatingParent.scrollLeft(i)),d[t]=e)},_modeChange:function(t,e,i){var s,d,r,n,a,f,h,l=this.dom[e],c=this.s.position,p=this._scrollEnabled();"footer"===e&&p||(s=function(t){l.floating[0].style.setProperty("width",t+"px","important"),p||l.floatingParent[0].style.setProperty("width",t+"px","important")},n=this.dom["footer"===e?"tfoot":"thead"],d=o.contains(n[0],document.activeElement)?document.activeElement:null,a=o(o(this.s.dt.table().node()).parent()),"in-place"===t?(l.placeholder&&(l.placeholder.remove(),l.placeholder=null),"header"===e?l.host.prepend(n):l.host.append(n),l.floating&&(l.floating.remove(),l.floating=null,this._stickyPosition(l.host,"+")),l.floatingParent&&(l.floatingParent.find("div.dtfc-top-blocker").remove(),l.floatingParent.remove()),o(o(l.host.parent()).parent()).scrollLeft(a.scrollLeft())):"in"===t?(this._clone(e,i),n=a.offset(),h=(r=o(document).scrollTop())+o(window).height(),f=p?n.top:c.tbodyTop,n=p?n.top+a.outerHeight():c.tfootTop,a="footer"===e?h<f?c.tfootHeight:f+c.tfootHeight-h:r+this.c.headerOffset+c.theadHeight-n,f="header"===e?"top":"bottom",h=this.c[e+"Offset"]-(0<a?a:0),l.floating.addClass("fixedHeader-floating"),l.floatingParent.css(f,h).css({left:c.left,"z-index":3}),s(c.width),"footer"===e&&l.floating.css("top","")):"below"===t?(this._clone(e,i),l.floating.addClass("fixedHeader-locked"),l.floatingParent.css({position:"absolute",top:c.tfootTop-c.theadHeight,left:c.left+"px"}),s(c.width)):"above"===t&&(this._clone(e,i),l.floating.addClass("fixedHeader-locked"),l.floatingParent.css({position:"absolute",top:c.tbodyTop,left:c.left+"px"}),s(c.width)),d&&d!==document.activeElement&&setTimeout((function(){d.focus()}),10),this.s.scrollLeft.header=-1,this.s.scrollLeft.footer=-1,this.s[e+"Mode"]=t)},_positions:function(){var t=(r=this.s.dt).table(),e=this.s.position,i=this.dom,s=(t=o(t.node()),this._scrollEnabled()),d=o(r.table().header()),r=o(r.table().footer()),n=(i=i.tbody,t.parent());e.visible=t.is(":visible"),e.width=t.outerWidth(),e.left=t.offset().left,e.theadTop=d.offset().top,e.tbodyTop=(s?n:i).offset().top,e.tbodyHeight=(s?n:i).outerHeight(),e.theadHeight=d.outerHeight(),e.theadBottom=e.theadTop+e.theadHeight,e.tfootTop=e.tbodyTop+e.tbodyHeight,r.length?(e.tfootBottom=e.tfootTop+r.outerHeight(),e.tfootHeight=r.outerHeight()):(e.tfootBottom=e.tfootTop,e.tfootHeight=0)},_scroll:function(t){var e,i,s,d,r,n,a,f,h,l,c,p,g,u,b;this.s.dt.settings()[0].bDestroying||(e=this._scrollEnabled(),s=(i=o(this.s.dt.table().node()).parent()).offset(),l=i.outerHeight(),d=o(document).scrollLeft(),r=o(document).scrollTop(),n=o(window).height()+r,c=this.s.position,p=e?s.top:c.tbodyTop,f=(e?s:c).left,l=e?s.top+l:c.tfootTop,h=e?i.outerWidth():c.tbodyWidth,this.c.header&&(!this.s.enable||!c.visible||r+this.c.headerOffset+c.theadHeight<=p?a="in-place":r+this.c.headerOffset+c.theadHeight>p&&r+this.c.headerOffset+c.theadHeight<l?(a="in",r+this.c.headerOffset+c.theadHeight>l||void 0===this.dom.header.floatingParent?t=!0:this.dom.header.floatingParent.css({top:this.c.headerOffset,position:"fixed"}).children().eq(0).append(this.dom.header.floating)):a="below",!t&&a===this.s.headerMode||this._modeChange(a,"header",t),this._horizontal("header",d)),g={offset:{top:0,left:0},height:0},u={offset:{top:0,left:0},height:0},this.c.footer&&this.dom.tfoot.length&&this.dom.tfoot.find("th, td").length&&(!this.s.enable||!c.visible||c.tfootBottom+this.c.footerOffset<=n?b="in-place":l+c.tfootHeight+this.c.footerOffset>n&&p+this.c.footerOffset<n?(b="in",t=!0):b="above",!t&&b===this.s.footerMode||this._modeChange(b,"footer",t),this._horizontal("footer",d),l=function(t){return{offset:t.offset(),height:t.outerHeight()}},g=this.dom.header.floating?l(this.dom.header.floating):l(this.dom.thead),u=this.dom.footer.floating?l(this.dom.footer.floating):l(this.dom.tfoot),e)&&u.offset.top>r&&(p=n+((c=r-s.top)>-g.height?c:0)-(g.offset.top+(c<-g.height?g.height:0)+u.height),i.outerHeight(p=p<0?0:p),Math.round(i.outerHeight())>=Math.round(p)?o(this.dom.tfoot.parent()).addClass("fixedHeader-floating"):o(this.dom.tfoot.parent()).removeClass("fixedHeader-floating")),this.dom.header.floating&&this.dom.header.floatingParent.css("left",f-d),this.dom.footer.floating&&this.dom.footer.floatingParent.css("left",f-d),void 0!==this.s.dt.settings()[0]._fixedColumns&&(this.dom.header.rightBlocker=(b=function(t,e,i){var s;return null!==(i=void 0===i?0===(s=o("div.dtfc-"+t+"-"+e+"-blocker")).length?null:s.clone().css("z-index",1):i)&&("in"===a||"below"===a?i.appendTo("body").css({top:("top"===e?g:u).offset.top,left:"right"===t?f+h-i.width():f}):i.detach()),i})("right","top",this.dom.header.rightBlocker),this.dom.header.leftBlocker=b("left","top",this.dom.header.leftBlocker),this.dom.footer.rightBlocker=b("right","bottom",this.dom.footer.rightBlocker),this.dom.footer.leftBlocker=b("left","bottom",this.dom.footer.leftBlocker)))},_scrollEnabled:function(){var t=this.s.dt.settings()[0].oScroll;return""!==t.sY||""!==t.sX},_widths:function(t){if(t&&t.placeholder)for(var e=o(this.s.dt.table().node()),i=o(e.parent()),s=(t.floatingParent.css("width",i[0].offsetWidth),t.floating.css("width",e[0].offsetWidth),o("colgroup",t.floating).remove(),t.placeholder.parent().find("colgroup").clone().appendTo(t.floating).find("col")),d=this.s.dt.columns(":visible").widths(),r=0;r<d.length;r++)s.eq(r).css("width",d[r])}}),s.version="4.0.1",s.defaults={header:!0,footer:!1,headerOffset:0,footerOffset:0},o.fn.dataTable.FixedHeader=s,o.fn.DataTable.FixedHeader=s,o(document).on("init.dt.dtfh",(function(t,i,d){var r;"dt"===t.namespace&&(t=i.oInit.fixedHeader,r=e.defaults.fixedHeader,t||r)&&!i._fixedHeader&&(r=o.extend({},r,t),!1!==t)&&new s(i,r)})),e.Api.register("fixedHeader()",(function(){})),e.Api.register("fixedHeader.adjust()",(function(){return this.iterator("table",(function(t){(t=t._fixedHeader)&&t.update()}))})),e.Api.register("fixedHeader.enable()",(function(t){return this.iterator("table",(function(e){e=e._fixedHeader,t=void 0===t||t,e&&t!==e.enabled()&&e.enable(t)}))})),e.Api.register("fixedHeader.enabled()",(function(){if(this.context.length){var t=this.context[0]._fixedHeader;if(t)return t.enabled()}return!1})),e.Api.register("fixedHeader.disable()",(function(){return this.iterator("table",(function(t){(t=t._fixedHeader)&&t.enabled()&&t.enable(!1)}))})),o.each(["header","footer"],(function(t,o){e.Api.register("fixedHeader."+o+"Offset()",(function(t){var e=this.context;return void 0===t?e.length&&e[0]._fixedHeader?e[0]._fixedHeader[o+"Offset"]():void 0:this.iterator("table",(function(e){(e=e._fixedHeader)&&e[o+"Offset"](t)}))}))}));export default e;