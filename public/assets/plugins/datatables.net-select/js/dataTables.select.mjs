/*! For license information please see dataTables.select.mjs.LICENSE.txt */
import e from"jquery";import t from"datatables.net";let l=e;function s(e,t,l){var s,c,n,o=function(t,l){if(t>l){var s=l;l=t,t=s}var c=!1;return e.columns(":visible").indexes().filter((function(e){return e===t&&(c=!0),e===l?(c=!1,!0):c}))},a=function(t,l){var s=e.rows({search:"applied"}).indexes();if(s.indexOf(t)>s.indexOf(l)){var c=l;l=t,t=c}var n=!1;return s.filter((function(e){return e===t&&(n=!0),e===l?(n=!1,!0):n}))};e.cells({selected:!0}).any()||l?(c=o(l.column,t.column),n=a(l.row,t.row)):(c=o(0,t.column),n=a(0,t.row)),s=e.cells(n,c).flatten(),e.cells(t,{selected:!0}).any()?e.cells(s).deselect():e.cells(s).select()}function c(e){var l=t.select.classes.checkbox;return e?l.replace(/ /g,"."):l}function n(e){var t=e.settings()[0]._select.selector;l(e.table().container()).off("mousedown.dtSelect",t).off("mouseup.dtSelect",t).off("click.dtSelect",t),l("body").off("click.dtSelect"+h(e.table().node()))}function o(e){var t,s=l(e.table().container()),c=e.settings()[0],n=c._select.selector;s.on("mousedown.dtSelect",n,(function(e){(e.shiftKey||e.metaKey||e.ctrlKey)&&s.css("-moz-user-select","none").one("selectstart.dtSelect",n,(function(){return!1})),window.getSelection&&(t=window.getSelection())})).on("mouseup.dtSelect",n,(function(){s.css("-moz-user-select","")})).on("click.dtSelect",n,(function(s){var c,n=e.select.items();if(t){var o=window.getSelection();if((!o.anchorNode||l(o.anchorNode).closest("table")[0]===e.table().node())&&o!==t)return}var i=e.settings()[0],r=e.table().container();if(l(s.target).closest("div.dt-container")[0]==r){var u=e.cell(l(s.target).closest("td, th"));if(u.any()){var d=l.Event("user-select.dt");if(a(e,d,[n,u,s]),!d.isDefaultPrevented()){var h=u.index();"row"===n?(c=h.row,f(s,e,i,"row",c)):"column"===n?(c=u.index().column,f(s,e,i,"column",c)):"cell"===n&&(c=u.index(),f(s,e,i,"cell",c)),i._select_lastCell=h}}}})),l("body").on("click.dtSelect"+h(e.table().node()),(function(t){if(c._select.blurable){if(l(t.target).parents().filter(e.table().container()).length)return;if(0===l(t.target).parents("html").length)return;if(l(t.target).parents("div.DTE").length)return;var s=l.Event("select-blur.dt");if(a(e,s,[t.target,t]),s.isDefaultPrevented())return;d(c,!0)}}))}function a(e,t,s,c){c&&!e.flatten().length||("string"==typeof t&&(t+=".dt"),s.unshift(e),l(e.table().node()).trigger(t,s))}function i(e,t){if("api"!==e.select.style()&&!1!==e.select.info()){var s=e.rows({selected:!0}).flatten().length,c=e.columns({selected:!0}).flatten().length,n=e.cells({selected:!0}).flatten().length,o=function(t,s,c){t.append(l('<span class="select-item"/>').append(e.i18n("select."+s+"s",{_:"%d "+s+"s selected",0:"",1:"1 "+s+" selected"},c)))},a=l(t),i=l('<span class="select-info"/>');o(i,"row",s),o(i,"column",c),o(i,"cell",n);var r=a.children("span.select-info");r.length&&r.remove(),""!==i.text()&&a.append(i)}}function r(e,t){e.columns(".dt-select").every((function(){var s=this.header();if(!l("input",s).length){var n=l("<input>").attr({class:c(!0),type:"checkbox","aria-label":e.i18n("select.aria.headerCheckbox")||"Select all rows"}).appendTo(s).on("change",(function(){this.checked?"select-page"==t?e.rows({page:"current"}).select():e.rows({search:"applied"}).select():e.rows({selected:!0}).deselect()})).on("click",(function(e){e.stopPropagation()}));e.on("draw select deselect",(function(l,s,c){if("row"===c||!c){var o=e.rows({selected:!0}).count(),a=e.rows({search:"applied",selected:!0}).count(),i="select-page"==t?e.rows({page:"current"}).count():e.rows({search:"applied"}).count();a&&a<=o&&a===i?n.prop("checked",!0).prop("indeterminate",!1):0===a&&0===o?n.prop("checked",!1).prop("indeterminate",!1):n.prop("checked",!1).prop("indeterminate",!0)}}))}}))}function u(e,t,l,s){var c=e[t+"s"]({search:"applied"}).indexes(),n=c.indexOf(s),o=c.indexOf(l);if(e[t+"s"]({selected:!0}).any()||-1!==n){if(n>o){var a=o;o=n,n=a}c.splice(o+1,c.length),c.splice(0,n)}else c.splice(c.indexOf(l)+1,c.length);e[t](l,{selected:!0}).any()?(c.splice(c.indexOf(l),1),e[t+"s"](c).deselect()):e[t+"s"](c).select()}function d(e,l){if(l||"single"===e._select.style){var s=new t.Api(e);s.rows({selected:!0}).deselect(),s.columns({selected:!0}).deselect(),s.cells({selected:!0}).deselect()}}function f(e,t,l,c,n){var o=t.select.style(),a=t.select.toggleable(),i=t[c](n,{selected:!0}).any();if(!i||a)if("os"===o)if(e.ctrlKey||e.metaKey)t[c](n).select(!i);else if(e.shiftKey)"cell"===c?s(t,n,l._select_lastCell||null):u(t,c,n,l._select_lastCell?l._select_lastCell[c]:null);else{var r=t[c+"s"]({selected:!0});i&&1===r.flatten().length?t[c](n).deselect():(r.deselect(),t[c](n).select())}else"multi+shift"==o&&e.shiftKey?"cell"===c?s(t,n,l._select_lastCell||null):u(t,c,n,l._select_lastCell?l._select_lastCell[c]:null):t[c](n).select(!i)}function h(e){return e.id.replace(/[^a-zA-Z0-9\-\_]/g,"-")}t.select={},t.select.classes={checkbox:"dt-select-checkbox"},t.select.version="2.0.3",t.select.init=function(e){var s=e.settings()[0];if(!t.versionCheck("2"))throw"Warning: Select requires DataTables 2 or newer";if(!s._select){var c=e.state.loaded(),n=function(t,l,s){if(null!==s&&void 0!==s.select){if(e.rows({selected:!0}).any()&&e.rows().deselect(),void 0!==s.select.rows&&e.rows(s.select.rows).select(),e.columns({selected:!0}).any()&&e.columns().deselect(),void 0!==s.select.columns&&e.columns(s.select.columns).select(),e.cells({selected:!0}).any()&&e.cells().deselect(),void 0!==s.select.cells)for(var c=0;c<s.select.cells.length;c++)e.cell(s.select.cells[c].row,s.select.cells[c].column).select();e.state.save()}};e.on("stateSaveParams",(function(t,l,s){s.select={},s.select.rows=e.rows({selected:!0}).ids(!0).toArray(),s.select.columns=e.columns({selected:!0})[0],s.select.cells=e.cells({selected:!0})[0].map((function(t){return{row:e.row(t.row).id(!0),column:t.column}}))})).on("stateLoadParams",n).one("init",(function(){n(0,0,c)}));var o=s.oInit.select,a=t.defaults.select,i=void 0===o?a:o,u="row",d="api",f=!1,h=!0,m=!0,v="td, th",_="selected",p=!0,w=!1;s._select={infoEls:[]},!0===i?(d="os",w=!0):"string"==typeof i?(d=i,w=!0):l.isPlainObject(i)&&(void 0!==i.blurable&&(f=i.blurable),void 0!==i.toggleable&&(h=i.toggleable),void 0!==i.info&&(m=i.info),void 0!==i.items&&(u=i.items),void 0!==i.style?(d=i.style,w=!0):(d="os",w=!0),void 0!==i.selector&&(v=i.selector),void 0!==i.className&&(_=i.className),void 0!==i.headerCheckbox&&(p=i.headerCheckbox)),e.select.selector(v),e.select.items(u),e.select.style(d),e.select.blurable(f),e.select.toggleable(h),e.select.info(m),s._select.className=_,!w&&l(e.table().node()).hasClass("selectable")&&e.select.style("os"),(p||"select-page"===p||"select-all"===p)&&(r(e,p),e.on("init",(function(){r(e,p)})))}},l.each([{type:"row",prop:"aoData"},{type:"column",prop:"aoColumns"}],(function(e,l){t.ext.selector[l.type].push((function(e,t,s){var c,n=t.selected,o=[];if(!0!==n&&!1!==n)return s;for(var a=0,i=s.length;a<i;a++)(c=e[l.prop][s[a]])&&(!0===n&&!0===c._select_selected||!1===n&&!c._select_selected)&&o.push(s[a]);return o}))})),t.ext.selector.cell.push((function(e,t,l){var s,c=t.selected,n=[];if(void 0===c)return l;for(var o=0,a=l.length;o<a;o++)(s=e.aoData[l[o].row])&&(!0===c&&s._selected_cells&&!0===s._selected_cells[l[o].column]||!1===c&&(!s._selected_cells||!s._selected_cells[l[o].column]))&&n.push(l[o]);return n}));var m=t.Api.register,v=t.Api.registerPlural;function _(e,t){return function(l){return l.i18n("buttons."+e,t)}}function p(e){var t=e._eventNamespace;return"draw.dt.DT"+t+" select.dt.DT"+t+" deselect.dt.DT"+t}m("select()",(function(){return this.iterator("table",(function(e){t.select.init(new t.Api(e))}))})),m("select.blurable()",(function(e){return void 0===e?this.context[0]._select.blurable:this.iterator("table",(function(t){t._select.blurable=e}))})),m("select.toggleable()",(function(e){return void 0===e?this.context[0]._select.toggleable:this.iterator("table",(function(t){t._select.toggleable=e}))})),m("select.info()",(function(e){return void 0===e?this.context[0]._select.info:this.iterator("table",(function(t){t._select.info=e}))})),m("select.items()",(function(e){return void 0===e?this.context[0]._select.items:this.iterator("table",(function(l){l._select.items=e,a(new t.Api(l),"selectItems",[e])}))})),m("select.style()",(function(e){return void 0===e?this.context[0]._select.style:this.iterator("table",(function(s){s._select||t.select.init(new t.Api(s)),s._select_init||function(e){var s=new t.Api(e);e._select_init=!0,e.aoRowCreatedCallback.push((function(t,s,n){var o,a,i=e.aoData[n];for(i._select_selected&&l(t).addClass(e._select.className).find("input."+c(!0)).prop("checked",!0),o=0,a=e.aoColumns.length;o<a;o++)(e.aoColumns[o]._select_selected||i._selected_cells&&i._selected_cells[o])&&l(i.anCells[o]).addClass(e._select.className)})),s.on("preXhr.dt.dtSelect",(function(e,t){if(t===s.settings()[0]){var l=s.rows({selected:!0}).ids(!0).filter((function(e){return void 0!==e})),c=s.cells({selected:!0}).eq(0).map((function(e){var t=s.row(e.row).id(!0);return t?{row:t,column:e.column}:void 0})).filter((function(e){return void 0!==e}));s.one("draw.dt.dtSelect",(function(){s.rows(l).select(),c.any()&&c.each((function(e){s.cells(e.row,e.column).select()}))}))}})),s.on("info.dt",(function(e,t,l){t._select.infoEls.includes(l)||t._select.infoEls.push(l),i(s,l)})),s.on("select.dtSelect.dt deselect.dtSelect.dt",(function(){e._select.infoEls.forEach((function(e){i(s,e)})),s.state.save()})),s.on("destroy.dtSelect",(function(){l(s.rows({selected:!0}).nodes()).removeClass(s.settings()[0]._select.className),n(s),s.off(".dtSelect"),l("body").off(".dtSelect"+h(s.table().node()))}))}(s),s._select.style=e;var r=new t.Api(s);n(r),"api"!==e&&o(r),a(new t.Api(s),"selectStyle",[e])}))})),m("select.selector()",(function(e){return void 0===e?this.context[0]._select.selector:this.iterator("table",(function(l){n(new t.Api(l)),l._select.selector=e,"api"!==l._select.style&&o(new t.Api(l))}))})),m("select.last()",(function(e){let t=this.context[0];return e?(t._select_lastCell=e,this):t._select_lastCell})),v("rows().select()","row().select()",(function(e){var t=this;return!1===e?this.deselect():(this.iterator("row",(function(e,s){d(e);var n=e.aoData[s],o=e.aoColumns;l(n.nTr).addClass(e._select.className),n._select_selected=!0;for(var a=0;a<o.length;a++){var i=o[a];if(null===i.sType&&t.columns().types(),"select-checkbox"===i.sType){var r=n.anCells;r&&r[a]&&l("input."+c(!0),r[a]).prop("checked",!0),null!==n._aSortData&&(n._aSortData[a]=null)}}})),this.iterator("table",(function(e,l){a(t,"select",["row",t[l]],!0)})),this)})),m("row().selected()",(function(){var e=this.context[0];return!!(e&&this.length&&e.aoData[this[0]]&&e.aoData[this[0]]._select_selected)})),v("columns().select()","column().select()",(function(e){var s=this;return!1===e?this.deselect():(this.iterator("column",(function(e,s){d(e),e.aoColumns[s]._select_selected=!0;var c=new t.Api(e).column(s);l(c.header()).addClass(e._select.className),l(c.footer()).addClass(e._select.className),c.nodes().to$().addClass(e._select.className)})),this.iterator("table",(function(e,t){a(s,"select",["column",s[t]],!0)})),this)})),m("column().selected()",(function(){var e=this.context[0];return!!(e&&this.length&&e.aoColumns[this[0]]&&e.aoColumns[this[0]]._select_selected)})),v("cells().select()","cell().select()",(function(e){var t=this;return!1===e?this.deselect():(this.iterator("cell",(function(e,t,s){d(e);var c=e.aoData[t];void 0===c._selected_cells&&(c._selected_cells=[]),c._selected_cells[s]=!0,c.anCells&&l(c.anCells[s]).addClass(e._select.className)})),this.iterator("table",(function(e,l){a(t,"select",["cell",t.cells(t[l]).indexes().toArray()],!0)})),this)})),m("cell().selected()",(function(){var e=this.context[0];if(e&&this.length){var t=e.aoData[this[0][0].row];if(t&&t._selected_cells&&t._selected_cells[this[0][0].column])return!0}return!1})),v("rows().deselect()","row().deselect()",(function(){var e=this;return this.iterator("row",(function(t,s){var n=t.aoData[s],o=t.aoColumns;l(n.nTr).removeClass(t._select.className),n._select_selected=!1,t._select_lastCell=null;for(var a=0;a<o.length;a++){var i=o[a];if(null===i.sType&&e.columns().types(),"select-checkbox"===i.sType){var r=n.anCells;r&&r[a]&&l("input."+c(!0),n.anCells[a]).prop("checked",!1),null!==n._aSortData&&(n._aSortData[a]=null)}}})),this.iterator("table",(function(t,l){a(e,"deselect",["row",e[l]],!0)})),this})),v("columns().deselect()","column().deselect()",(function(){var e=this;return this.iterator("column",(function(e,s){e.aoColumns[s]._select_selected=!1;var c=new t.Api(e),n=c.column(s);l(n.header()).removeClass(e._select.className),l(n.footer()).removeClass(e._select.className),c.cells(null,s).indexes().each((function(t){var s=e.aoData[t.row],c=s._selected_cells;!s.anCells||c&&c[t.column]||l(s.anCells[t.column]).removeClass(e._select.className)}))})),this.iterator("table",(function(t,l){a(e,"deselect",["column",e[l]],!0)})),this})),v("cells().deselect()","cell().deselect()",(function(){var e=this;return this.iterator("cell",(function(e,t,s){var c=e.aoData[t];void 0!==c._selected_cells&&(c._selected_cells[s]=!1),c.anCells&&!e.aoColumns[s]._select_selected&&l(c.anCells[s]).removeClass(e._select.className)})),this.iterator("table",(function(t,l){a(e,"deselect",["cell",e[l]],!0)})),this}));var w=0;l.extend(t.ext.buttons,{selected:{text:_("selected","Selected"),className:"buttons-selected",limitTo:["rows","columns","cells"],init:function(e,t,l){var s=this;l._eventNamespace=".select"+w++,e.on(p(l),(function(){s.enable(function(e,t){return!(-1===t.limitTo.indexOf("rows")||!e.rows({selected:!0}).any())||!(-1===t.limitTo.indexOf("columns")||!e.columns({selected:!0}).any())||!(-1===t.limitTo.indexOf("cells")||!e.cells({selected:!0}).any())}(e,l))})),this.disable()},destroy:function(e,t,l){e.off(l._eventNamespace)}},selectedSingle:{text:_("selectedSingle","Selected single"),className:"buttons-selected-single",init:function(e,t,l){var s=this;l._eventNamespace=".select"+w++,e.on(p(l),(function(){var t=e.rows({selected:!0}).flatten().length+e.columns({selected:!0}).flatten().length+e.cells({selected:!0}).flatten().length;s.enable(1===t)})),this.disable()},destroy:function(e,t,l){e.off(l._eventNamespace)}},selectAll:{text:_("selectAll","Select all"),className:"buttons-select-all",action:function(e,t,l,s){var c=this.select.items(),n=s.selectorModifier;n?("function"==typeof n&&(n=n.call(t,e,t,l,s)),this[c+"s"](n).select()):this[c+"s"]().select()}},selectNone:{text:_("selectNone","Deselect all"),className:"buttons-select-none",action:function(){d(this.settings()[0],!0)},init:function(e,t,l){var s=this;l._eventNamespace=".select"+w++,e.on(p(l),(function(){var t=e.rows({selected:!0}).flatten().length+e.columns({selected:!0}).flatten().length+e.cells({selected:!0}).flatten().length;s.enable(t>0)})),this.disable()},destroy:function(e,t,l){e.off(l._eventNamespace)}},showSelected:{text:_("showSelected","Show only selected"),className:"buttons-show-selected",action:function(e,t){if(t.search.fixed("dt-select"))t.search.fixed("dt-select",null),this.active(!1);else{var l=t.settings()[0].aoData;t.search.fixed("dt-select",(function(e,t,s){return l[s]._select_selected})),this.active(!0)}t.draw()}}}),l.each(["Row","Column","Cell"],(function(e,l){var s=l.toLowerCase();t.ext.buttons["select"+l+"s"]={text:_("select"+l+"s","Select "+s+"s"),className:"buttons-select-"+s+"s",action:function(){this.select.items(s)},init:function(e){var t=this;e.on("selectItems.dt.DT",(function(e,l,c){t.active(c===s)}))}}})),t.type("select-checkbox",{className:"dt-select",detect:function(e){return"select-checkbox"===e&&e},order:{pre:function(e){return"X"===e?-1:0}}}),l.extend(!0,t.defaults.oLanguage,{select:{aria:{rowCheckbox:"Select row"}}}),t.render.select=function(e,s){var n=e?t.util.get(e):null,o=s?t.util.get(s):null;return function(e,t,s,a){var i=a.settings.aoData[a.row]._select_selected,r=a.settings.oLanguage.select.aria.rowCheckbox;return"display"===t?l("<input>").attr({"aria-label":r,class:c(),name:o?o(s):null,type:"checkbox",value:n?n(s):null,checked:i}).on("input",(function(e){e.preventDefault(),this.checked=l(this).closest("tr").hasClass("selected")}))[0]:"type"===t?"select-checkbox":"filter"===t?"":i?"X":""}},t.ext.order["select-checkbox"]=function(e,t){return this.api().column(t,{order:"index"}).nodes().map((function(t){return"row"===e._select.items?l(t).parent().hasClass(e._select.className):"cell"===e._select.items&&l(t).hasClass(e._select.className)}))},l.fn.DataTable.select=t.select,l(document).on("preInit.dt.dtSelect",(function(e,l){"dt"===e.namespace&&t.select.init(new t.Api(l))}));export default t;