/*! For license information please see dataTables.rowGroup.min.mjs.LICENSE.txt */
import t from"jquery";import r from"datatables.net";let e=t;var o=function(t,n){if(!r.versionCheck||!r.versionCheck("1.11"))throw"RowGroup requires DataTables 1.11 or newer";if(this.c=e.extend(!0,{},r.defaults.rowGroup,o.defaults,n),this.s={dt:new r.Api(t)},this.dom={},t=(n=this.s.dt.settings()[0]).rowGroup)return t;(n.rowGroup=this)._constructor()};e.extend(o.prototype,{dataSrc:function(t){var r;return void 0===t?this.c.dataSrc:(r=this.s.dt,this.c.dataSrc=t,e(r.table().node()).triggerHandler("rowgroup-datasrc.dt",[r,t]),this)},disable:function(){return this.c.enable=!1,this},enable:function(t){return!1===t?this.disable():(this.c.enable=!0,this)},enabled:function(){return this.c.enable},_constructor:function(){var t=this,r=this.s.dt,e=r.settings()[0];r.on("draw.dtrg",(function(r,o){t.c.enable&&e===o&&t._draw()})),r.on("column-visibility.dt.dtrg responsive-resize.dt.dtrg",(function(){t._adjustColspan()})),r.on("destroy",(function(){r.off(".dtrg")}))},_adjustColspan:function(){e("tr."+this.c.className,this.s.dt.table().body()).find("th:visible, td:visible").attr("colspan",this._colspan())},_colspan:function(){return this.s.dt.columns().visible().reduce((function(t,r){return t+r}),0)},_draw:function(){var t=this.s.dt;t=this._group(0,t.rows({page:"current"}).indexes());this._groupDisplay(0,t)},_group:function(t,e){for(var o,n=Array.isArray(this.c.dataSrc)?this.c.dataSrc:[this.c.dataSrc],s=r.util.get(n[t]),a=this.s.dt,i=[],d=0,u=e.length;d<u;d++){var c,l=e[d];null==(c=s(a.row(l).data(),t))&&(c=this.c.emptyDataGroup),void 0!==o&&c===o||(i.push({dataPoint:c,rows:[]}),o=c),i[i.length-1].rows.push(l)}if(void 0!==n[t+1])for(d=0,u=i.length;d<u;d++)i[d].children=this._group(t+1,i[d].rows);return i},_groupDisplay:function(t,r){for(var e,o=this.s.dt,n=0,s=r.length;n<s;n++){var a,i=r[n],d=i.dataPoint,u=i.rows;this.c.startRender&&(e=this.c.startRender.call(this,o.rows(u),d,t),a=this._rowWrap(e,this.c.startClassName,t))&&a.insertBefore(o.row(u[0]).node()),this.c.endRender&&(e=this.c.endRender.call(this,o.rows(u),d,t),a=this._rowWrap(e,this.c.endClassName,t))&&a.insertAfter(o.row(u[u.length-1]).node()),i.children&&this._groupDisplay(t+1,i.children)}},_rowWrap:function(t,r,o){return null==(t=null!==t&&""!==t?t:this.c.emptyDataGroup)?null:("object"==typeof t&&t.nodeName&&"tr"===t.nodeName.toLowerCase()?e(t):t instanceof e&&t.length&&"tr"===t[0].nodeName.toLowerCase()?t:e("<tr/>").append(e("<th/>").attr("colspan",this._colspan()).attr("scope","row").append(t))).addClass(this.c.className).addClass(r).addClass("dtrg-level-"+o)}}),o.defaults={className:"dtrg-group",dataSrc:0,emptyDataGroup:"No group",enable:!0,endClassName:"dtrg-end",endRender:null,startClassName:"dtrg-start",startRender:function(t,r){return r}},o.version="1.5.0",e.fn.dataTable.RowGroup=o,e.fn.DataTable.RowGroup=o,r.Api.register("rowGroup()",(function(){return this})),r.Api.register("rowGroup().disable()",(function(){return this.iterator("table",(function(t){t.rowGroup&&t.rowGroup.enable(!1)}))})),r.Api.register("rowGroup().enable()",(function(t){return this.iterator("table",(function(r){r.rowGroup&&r.rowGroup.enable(void 0===t||t)}))})),r.Api.register("rowGroup().enabled()",(function(){var t=this.context;return!(!t.length||!t[0].rowGroup)&&t[0].rowGroup.enabled()})),r.Api.register("rowGroup().dataSrc()",(function(t){return void 0===t?this.context[0].rowGroup.dataSrc():this.iterator("table",(function(r){r.rowGroup&&r.rowGroup.dataSrc(t)}))})),e(document).on("preInit.dt.dtrg",(function(t,n,s){var a,i;"dt"===t.namespace&&(t=n.oInit.rowGroup,a=r.defaults.rowGroup,t||a)&&(i=e.extend({},a,t),!1!==t)&&new o(n,i)}));export default r;