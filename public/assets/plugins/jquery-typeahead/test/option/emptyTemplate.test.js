const $=require("jquery"),Typeahead=require("../../src/jquery.typeahead");describe("Typeahead emptyTemplate option Tests",(()=>{"use strict";let e;describe("String",(()=>{beforeAll((()=>{document.body.innerHTML='<input class="js-typeahead">',e=$.typeahead({input:".js-typeahead",minLength:0,generateOnLoad:!0,emptyTemplate:"No result for {{query}}",source:{data:["test"]}})})),it("Should output a String",(()=>{e.node.val("eMpTy"),e.node.trigger("input"),expect(e.resultHtml.find("li").length).toEqual(1),expect(e.resultHtml.text()).toEqual("No result for eMpTy")}))})),describe("Function that returns a String",(()=>{beforeAll((()=>{e.options.emptyTemplate=function(e){return'No results for "'+e+'"'}})),it("Should output a String from a Function",(()=>{e.node.val("Empty"),e.node.trigger("input"),expect(e.resultHtml.find("li").length).toEqual(1),expect(e.resultHtml.text()).toEqual('No results for "Empty"')}))})),describe("Function that returns a jQuery Object",(()=>{beforeAll((()=>{e.options.emptyTemplate=function(e){return $("<li>",{text:'Just use "'+e+'"',class:"my-custom-class"})}})),it("Should output a jQuery object from a Function",(()=>{e.node.val("Empty"),e.node.trigger("input"),expect(e.resultHtml.find("li").length).toEqual(1),expect(e.resultHtml.text()).toEqual('Just use "Empty"')}))})),describe("The emptyTemplate is sanitized",(()=>{beforeAll((()=>{e.options.emptyTemplate="<div>No result for {{query}}</div>"})),it('Should preserve the div tag and sanitize the "query"',(()=>{e.node.val('<img src="" onerror="alert(\'bad code\')">'),e.node.trigger("input"),expect(e.resultHtml.html()).toEqual('<li class="typeahead__empty"><div>No result for &lt;img src="" onerror="alert(\'bad code\')"&gt;</div></li>')}))}))})),describe("Typeahead emptyTemplate option Tests when a response is null",(()=>{let e,t;beforeAll((()=>{document.body.innerHTML='<input class="js-typeahead">',e=$.typeahead({input:".js-typeahead",minLength:0,generateOnLoad:!0,source:{ajax:{url:"/null.json",callback:{done:function(e,l,r){t=e}}}},emptyTemplate:"No results for {{query}}"})})),it("Should assign the proper Typeahead selector",(l=>{e.node.val("Empty"),e.node.trigger("input"),e.node.triggerHandler("input").done((function(){expect(t).toEqual(null),expect(e.resultHtml.find("li").length).toEqual(1),expect(e.resultHtml.text()).toEqual("No results for Empty"),l()}))})),afterAll((()=>{delete window.Typeahead[".js-typeahead"]}))})),describe("Typeahead emptyTemplate option Tests when a response is empty Array",(()=>{let e,t;beforeAll((()=>{document.body.innerHTML='<input class="js-typeahead">',e=$.typeahead({input:".js-typeahead",minLength:0,generateOnLoad:!0,source:{ajax:{url:"/empty.json",callback:{done:function(e,l,r){t=e}}}},emptyTemplate:"No results for {{query}}"})})),it("Should assign the proper Typeahead selector",(l=>{e.node.val("Empty"),e.node.triggerHandler("input").done((function(){expect(t).toEqual([]),expect(e.resultHtml.find("li").length).toEqual(1),expect(e.resultHtml.text()).toEqual("No results for Empty"),l()}))})),afterAll((()=>{delete window.Typeahead[".js-typeahead"]}))}));