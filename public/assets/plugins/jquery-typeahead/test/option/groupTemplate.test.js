const $=require("jquery"),Typeahead=require("../../src/jquery.typeahead");describe("Typeahead groupTemplate option Tests",(()=>{"use strict";let e;describe("Hardcoded template",(()=>{beforeAll((()=>{document.body.innerHTML='<input class="js-typeahead">',e=$.typeahead({input:".js-typeahead",minLength:0,generateOnLoad:!0,groupTemplate:"\n                <table>\n                    <tr>\n                        <td>{{group_one}}</td>\n                        <td>{{group_two}}</td>\n                        <td>{{group_three}}</td>\n                    </tr>\n                </table>".replace(/\s/g,""),source:{group_one:{data:["group_one_data_one","group_one_data_two","group_one_data_three","group_one_data_four"]},group_two:{data:["group_two_data_one","group_two_data_two","group_two_data_three","group_two_data_four","group_two_data_five"]},group_three:{data:["group_three_data_one","group_three_data_two","group_three_data_three","group_three_data_four"]}}})})),it("Should produce 3 <td>",(()=>{e.node.val("data_four"),e.node.trigger("input"),expect(e.result.length).toEqual(3),expect(e.resultHtml.find("td").length).toEqual(3),expect(e.resultHtml.find("a").length).toEqual(3)})),it("Should produce 1 <td>",(()=>{e.node.val("data_five"),e.node.trigger("input"),expect(e.result.length).toEqual(1),expect(e.resultHtml.find("td").length).toEqual(1),expect(e.resultHtml.find("a").length).toEqual(1)}))})),describe("Dynamic template",(()=>{beforeAll((()=>{e.options.groupOrder="desc",e.options.groupTemplate="\n            <table>\n                <tr>\n                    <td>{{group}}</td>\n                </tr>\n            </table>".replace(/\s/g,""),e.extendOptions()})),it('Should generate <td> from groups and order them "desc"',(()=>{e.node.val("data_four"),e.node.trigger("input"),expect(e.result.length).toEqual(3),expect(e.resultHtml.find("td").length).toEqual(3),expect(e.resultHtml.find("a").length).toEqual(3),expect(e.resultHtml.find("td:eq(0)").attr("data-group-template")).toEqual("group_two"),expect(e.resultHtml.find("td:eq(1)").attr("data-group-template")).toEqual("group_three"),expect(e.resultHtml.find("td:eq(2)").attr("data-group-template")).toEqual("group_one")}))}))})),describe("Typeahead groupTemplate configuration using groups",(()=>{let e;beforeAll((()=>{document.body.innerHTML='<input class="js-typeahead">',e=$.typeahead({input:".js-typeahead",display:["key"],filter:!1,dynamic:!0,highlight:!1,group:!0,groupOrder:["groupname3","groupname2","groupname1"],groupTemplate:'<div class="row"><div class="col-xl-3 col-sm-6">{{group}}</div></div>',template:function(){return"{{id}} {{key}}"},source:{groupname1:{data:[{id:1,key:"Test1"}]},groupname2:{data:[{id:1,key:"Test1"}]},groupname3:{data:[{id:1,key:"NO RESULTS"}]}}})})),it("Should display the right amount of results",(t=>{e.node.val("bla"),e.node.triggerHandler("input").done((function(){expect(e.result.length).toEqual(3),e.node.val("blabla"),e.node.triggerHandler("input").done((function(){expect(e.result.length).toEqual(3),t()}))}))})),afterAll((()=>{delete window.Typeahead[".js-typeahead"]}))}));