const $=require("jquery"),Typeahead=require("../../src/jquery.typeahead");describe("Typeahead onCancel Callback Tests",(()=>{"use strict";let e,t,a;beforeAll((()=>{document.body.innerHTML='<form>\n        <div class="typeahead__container">\n            <div class="typeahead__field">\n                <div class="typeahead__query">\n                    <input class="js-typeahead"\n                            name="q"\n                            autofocus\n                            autocomplete="off">\n                </div>\n                <div class="typeahead__button">\n                    <button type="submit">\n                        <span class="typeahead__search-icon"></span>\n                    </button>\n                </div>\n            </div>\n        </div>\n    </form>',e=$.typeahead({input:".js-typeahead",minLength:0,generateOnLoad:!0,display:["display"],template:"{{display}} {{details}}",emptyTemplate:"no result for {{query}}",source:[{id:"1",display:"Test"},{id:"2",display:"callback"}],callback:{onCancel:function(e,n,d){t=!0,a=n}}})})),beforeEach((()=>{t=!1})),it("Should call onCancel callback when ESC is pressed",(()=>{e.node.val("test"),e.node.trigger("input"),e.node.trigger($.Event("keydown",{keyCode:27})),expect(t).toBeTruthy()})),it("Should call onCancel callback if cancel button is clicked",(()=>{e.node.val("test"),e.node.trigger("input"),e.node.parent().find(".typeahead__cancel-button").trigger("mousedown"),expect(t).toBeTruthy()})),it("Should call onCancel callback if an item is selected and the input is cleared",(()=>{e.node.val("test"),e.node.trigger("input"),e.container.find("."+e.options.selector.item).eq(0).find("a").trigger("click"),e.node.trigger($.Event("keydown",{keyCode:27})),expect(t).toBeTruthy(),expect(a).toEqual({matchedKey:"display",id:"1",display:"Test",group:"group"})}))}));