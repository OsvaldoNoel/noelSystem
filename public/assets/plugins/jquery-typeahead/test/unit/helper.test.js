let pkg=require("../../package.json"),$=require("jquery"),Typeahead=require("../../src/jquery.typeahead");describe("Typeahead Helpers Tests",(function(){"use strict";let e;beforeAll((function(){document.body.innerHTML='<input class="js-typeahead">',e=$.typeahead({input:".js-typeahead",source:{testGroup:["item1","item2","item3"]},callback:{onInit:function(){return!0}}})})),it("Typeahead.version",(function(){expect(window.Typeahead.version).toEqual(pkg.version)})),it("Typeahead.prototype.helper.isEmpty",(function(){expect(Typeahead.prototype.helper.isEmpty).toBeDefined(),expect(Typeahead.prototype.helper.isEmpty({})).toBeTruthy(),expect(Typeahead.prototype.helper.isEmpty({test:"test"})).toBeFalsy()})),it("Typeahead.prototype.helper.removeAccent",(function(){expect(Typeahead.prototype.helper.removeAccent).toBeDefined(),expect(e.helper.removeAccent.call(e,"ãàáäâẽèéëêìíïîõòóöôùúüûñç")).toEqual("aaaaaeeeeeiiiiooooouuuunc")})),it("Typeahead.prototype.helper.slugify",(function(){expect(Typeahead.prototype.helper.slugify).toBeDefined(),expect(e.helper.slugify.call(e,"url with àccénts")).toEqual("url-with-accents"),expect(e.helper.slugify.call(e,"url  with   spaces")).toEqual("url-with-spaces"),expect(e.helper.slugify.call(e,"url with !@#$%?&?&*() special chars")).toEqual("url-with-special-chars"),expect(e.helper.slugify.call(e,"-url not start+=-end with-")).toEqual("url-not-start-end-with")})),it("Typeahead.prototype.helper.sort",(function(){let e=[{display:"aDisplay"},{display:"cDisplay"},{display:"bDisplay"}];expect(e.sort(Typeahead.prototype.helper.sort(["display"],!0,(function(e){return e.toString().toUpperCase()})))).toEqual([{display:"aDisplay"},{display:"bDisplay"},{display:"cDisplay"}]),expect(e.sort(Typeahead.prototype.helper.sort(["display"],!1,(function(e){return e.toString().toUpperCase()})))).toEqual([{display:"cDisplay"},{display:"bDisplay"},{display:"aDisplay"}])})),it("Typeahead.prototype.helper.replaceAt",(function(){expect(Typeahead.prototype.helper.replaceAt).toBeDefined(),expect(Typeahead.prototype.helper.replaceAt("thisisatest",4,2,"was")).toEqual("thiswasatest")})),it("Typeahead.prototype.helper.highlight",(function(){expect(Typeahead.prototype.helper.highlight).toBeDefined(),expect(e.helper.highlight.apply(e,["highlight test",["test"],!1])).toEqual("highlight <strong>test</strong>"),expect(e.helper.highlight.apply(e,["highlight àççént test",["accent"],!1])).toEqual("highlight àççént test"),expect(e.helper.highlight.apply(e,["highlight àççént test",["accent"],!0])).toEqual("highlight <strong>àççént</strong> test"),expect(e.helper.highlight.apply(e,["test keys highlight multiple test key",["test","key"],!1])).toEqual("<strong>test</strong> <strong>key</strong>s highlight multiple <strong>test</strong> <strong>key</strong>"),expect(e.helper.highlight.apply(e,["highlight number 42 test",["number 42"],!1])).toEqual("highlight <strong>number 42</strong> test")})),it("Typeahead.prototype.helper.getCaret",(function(){expect(Typeahead.prototype.helper.getCaret).toBeDefined(),e.node.val("test"),e.node[0].selectionStart=e.node.val().length,expect(e.helper.getCaret(e.node[0])).toEqual(4)})),it("Typeahead.prototype.helper.cleanStringFromScript",(function(){expect(Typeahead.prototype.helper.cleanStringFromScript).toBeDefined(),expect(e.helper.cleanStringFromScript(1)).toEqual(1),expect(e.helper.cleanStringFromScript(void 0)).toEqual(void 0),expect(e.helper.cleanStringFromScript(!0)).toEqual(!0),expect(e.helper.cleanStringFromScript("test")).toEqual("test"),expect(e.helper.cleanStringFromScript("<script>alert('test');<\/script>")).toEqual("alert('test');"),expect(e.helper.cleanStringFromScript("<script>alert('<iframe src='www.test.com'>test</iframe>');<\/script>")).toEqual("alert('test');")})),it("Typeahead.prototype.helper.executeCallback",(function(){window.definedTestFunction=function(){return!0},window.testFunctions={},window.testFunctions.oneTest={},window.testFunctions.oneTest.deepTest=function(e,t,p){return $.map(arguments,(function(e,t){return e}))},expect(Typeahead.prototype.helper.executeCallback).toBeDefined(),expect(e.helper.executeCallback.apply(e)).toBeUndefined(),expect(e.helper.executeCallback.apply(e,["undefinedTestFunction"])).toBeUndefined(),expect(e.helper.executeCallback.apply(e,["definedTestFunction"])).toBeTruthy(),expect(e.helper.executeCallback.apply(e,["window.testFunctions.oneTest.deepTest",[1,2,"test"]])).toEqual([1,2,"test"]),expect(e.helper.executeCallback.apply(e,[e.options.callback.onInit])).toBeTruthy()})),it("Typeahead.prototype.helper.namespace",(function(){let e={property:!0,test:"test",with:{deep:{property:!0}}};expect(Typeahead.prototype.helper.namespace).toBeDefined(),expect(Typeahead.prototype.helper.namespace("property",e)).toBeTruthy(),expect(Typeahead.prototype.helper.namespace("with.deep.property",e)).toBeTruthy(),expect(Typeahead.prototype.helper.namespace("new.property",e,"create","newProperty")).toEqual("newProperty"),expect(Typeahead.prototype.helper.namespace("new.property",e)).toEqual("newProperty"),expect(Typeahead.prototype.helper.namespace("new.property",e,"set","updatedProperty")).toEqual("updatedProperty"),expect(Typeahead.prototype.helper.namespace("new.property",e)).toEqual("updatedProperty"),expect(Typeahead.prototype.helper.namespace("new.property",e,"delete")).toBeTruthy(),expect(Typeahead.prototype.helper.namespace("new.property",e)).toBeUndefined(),expect(Typeahead.prototype.helper.namespace("undefined",e)).toBeUndefined(),expect(Typeahead.prototype.helper.namespace("undefined.property",e)).toBeUndefined(),expect(Typeahead.prototype.helper.namespace("undefined",e,"get","")).toEqual(""),expect(Typeahead.prototype.helper.namespace("undefined.property",e,"get","")).toEqual(""),expect(Typeahead.prototype.helper.namespace("undefined.property",e,"get","test")).toEqual("test")})),it("Typeahead.prototype.helper.typeWatch",(function(e){expect(Typeahead.prototype.helper.typeWatch).toBeDefined(),Typeahead.prototype.helper.typeWatch((function(){e()}),100)}))}));