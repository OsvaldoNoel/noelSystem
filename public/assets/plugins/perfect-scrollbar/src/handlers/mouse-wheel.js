import*as CSS from"../lib/css";import cls from"../lib/class-names";import updateGeometry from"../update-geometry";import{env}from"../lib/util";export default function(e){const t=e.element;function l(l){const[o,s]=function(e){let t=e.deltaX,l=-1*e.deltaY;return void 0!==t&&void 0!==l||(t=-1*e.wheelDeltaX/6,l=e.wheelDeltaY/6),e.deltaMode&&1===e.deltaMode&&(t*=10,l*=10),t!=t&&l!=l&&(t=0,l=e.wheelDelta),e.shiftKey?[-l,-t]:[t,l]}(l);if(function(e,l,o){if(!env.isWebKit&&t.querySelector("select:focus"))return!0;if(!t.contains(e))return!1;let s=e;for(;s&&s!==t;){if(s.classList.contains(cls.element.consuming))return!0;const e=CSS.get(s);if(o&&e.overflowY.match(/(scroll|auto)/)){const e=s.scrollHeight-s.clientHeight;if(e>0&&(s.scrollTop>0&&o<0||s.scrollTop<e&&o>0))return!0}if(l&&e.overflowX.match(/(scroll|auto)/)){const e=s.scrollWidth-s.clientWidth;if(e>0&&(s.scrollLeft>0&&l<0||s.scrollLeft<e&&l>0))return!0}s=s.parentNode}return!1}(l.target,o,s))return;let r=!1;e.settings.useBothWheelAxes?e.scrollbarYActive&&!e.scrollbarXActive?(s?t.scrollTop-=s*e.settings.wheelSpeed:t.scrollTop+=o*e.settings.wheelSpeed,r=!0):e.scrollbarXActive&&!e.scrollbarYActive&&(o?t.scrollLeft+=o*e.settings.wheelSpeed:t.scrollLeft-=s*e.settings.wheelSpeed,r=!0):(t.scrollTop-=s*e.settings.wheelSpeed,t.scrollLeft+=o*e.settings.wheelSpeed),updateGeometry(e),r=r||function(l,o){const s=Math.floor(t.scrollTop),r=0===t.scrollTop,i=s+t.offsetHeight===t.scrollHeight,n=0===t.scrollLeft,c=t.scrollLeft+t.offsetWidth===t.scrollWidth;let a;return a=Math.abs(o)>Math.abs(l)?r||i:n||c,!a||!e.settings.wheelPropagation}(o,s),r&&!l.ctrlKey&&(l.stopPropagation(),l.preventDefault())}void 0!==window.onwheel?e.event.bind(t,"wheel",l):void 0!==window.onmousewheel&&e.event.bind(t,"mousewheel",l)}