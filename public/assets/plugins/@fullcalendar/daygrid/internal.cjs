"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var internal_cjs=require("@fullcalendar/core/internal.cjs"),preact_cjs=require("@fullcalendar/core/preact.cjs");class TableView extends internal_cjs.DateComponent{constructor(){super(...arguments),this.headerElRef=preact_cjs.createRef()}renderSimpleLayout(e,t){let{props:n,context:s}=this,r=[],a=internal_cjs.getStickyHeaderDates(s.options);return e&&r.push({type:"header",key:"header",isSticky:a,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),r.push({type:"body",key:"body",liquid:!0,chunk:{content:t}}),preact_cjs.createElement(internal_cjs.ViewContainer,{elClasses:["fc-daygrid"],viewSpec:s.viewSpec},preact_cjs.createElement(internal_cjs.SimpleScrollGrid,{liquid:!n.isHeightAuto&&!n.forPrint,collapsibleWidth:n.forPrint,cols:[],sections:r}))}renderHScrollLayout(e,t,n,s){let r=this.context.pluginHooks.scrollGridImpl;if(!r)throw new Error("No ScrollGrid implementation");let{props:a,context:i}=this,l=!a.forPrint&&internal_cjs.getStickyHeaderDates(i.options),o=!a.forPrint&&internal_cjs.getStickyFooterScrollbar(i.options),c=[];return e&&c.push({type:"header",key:"header",isSticky:l,chunks:[{key:"main",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),c.push({type:"body",key:"body",liquid:!0,chunks:[{key:"main",content:t}]}),o&&c.push({type:"footer",key:"footer",isSticky:!0,chunks:[{key:"main",content:internal_cjs.renderScrollShim}]}),preact_cjs.createElement(internal_cjs.ViewContainer,{elClasses:["fc-daygrid"],viewSpec:i.viewSpec},preact_cjs.createElement(r,{liquid:!a.isHeightAuto&&!a.forPrint,forPrint:a.forPrint,collapsibleWidth:a.forPrint,colGroups:[{cols:[{span:n,minWidth:s}]}],sections:c}))}}function splitSegsByRow(e,t){let n=[];for(let e=0;e<t;e+=1)n[e]=[];for(let t of e)n[t.row].push(t);return n}function splitSegsByFirstCol(e,t){let n=[];for(let e=0;e<t;e+=1)n[e]=[];for(let t of e)n[t.firstCol].push(t);return n}function splitInteractionByRow(e,t){let n=[];if(e){for(let s=0;s<t;s+=1)n[s]={affectedInstances:e.affectedInstances,isEvent:e.isEvent,segs:[]};for(let t of e.segs)n[t.row].segs.push(t)}else for(let e=0;e<t;e+=1)n[e]=null;return n}const DEFAULT_TABLE_EVENT_TIME_FORMAT=internal_cjs.createFormatter({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function hasListItemDisplay(e){let{display:t}=e.eventRange.ui;return"list-item"===t||"auto"===t&&!e.eventRange.def.allDay&&e.firstCol===e.lastCol&&e.isStart&&e.isEnd}class TableBlockEvent extends internal_cjs.BaseComponent{render(){let{props:e}=this;return preact_cjs.createElement(internal_cjs.StandardEvent,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:DEFAULT_TABLE_EVENT_TIME_FORMAT,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}}class TableListItemEvent extends internal_cjs.BaseComponent{render(){let{props:e,context:t}=this,{options:n}=t,{seg:s}=e,r=n.eventTimeFormat||DEFAULT_TABLE_EVENT_TIME_FORMAT,a=internal_cjs.buildSegTimeText(s,r,t,!0,e.defaultDisplayEventEnd);return preact_cjs.createElement(internal_cjs.EventContainer,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:internal_cjs.getSegAnchorAttrs(e.seg,t),defaultGenerator:renderInnerContent,timeText:a,isResizing:!1,isDateSelecting:!1}))}}function renderInnerContent(e){return preact_cjs.createElement(preact_cjs.Fragment,null,preact_cjs.createElement("div",{className:"fc-daygrid-event-dot",style:{borderColor:e.borderColor||e.backgroundColor}}),e.timeText&&preact_cjs.createElement("div",{className:"fc-event-time"},e.timeText),preact_cjs.createElement("div",{className:"fc-event-title"},e.event.title||preact_cjs.createElement(preact_cjs.Fragment,null," ")))}class TableCellMoreLink extends internal_cjs.BaseComponent{constructor(){super(...arguments),this.compileSegs=internal_cjs.memoize(compileSegs)}render(){let{props:e}=this,{allSegs:t,invisibleSegs:n}=this.compileSegs(e.singlePlacements);return preact_cjs.createElement(internal_cjs.MoreLinkContainer,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:t,hiddenSegs:n,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let n=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return preact_cjs.createElement(preact_cjs.Fragment,null,t.map((t=>{let s=t.eventRange.instance.instanceId;return preact_cjs.createElement("div",{className:"fc-daygrid-event-harness",key:s,style:{visibility:n[s]?"hidden":""}},hasListItemDisplay(t)?preact_cjs.createElement(TableListItemEvent,Object.assign({seg:t,isDragging:!1,isSelected:s===e.eventSelection,defaultDisplayEventEnd:!1},internal_cjs.getSegMeta(t,e.todayRange))):preact_cjs.createElement(TableBlockEvent,Object.assign({seg:t,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:s===e.eventSelection,defaultDisplayEventEnd:!1},internal_cjs.getSegMeta(t,e.todayRange))))})))}})}}function compileSegs(e){let t=[],n=[];for(let s of e)t.push(s.seg),s.isVisible||n.push(s.seg);return{allSegs:t,invisibleSegs:n}}const DEFAULT_WEEK_NUM_FORMAT=internal_cjs.createFormatter({week:"narrow"});class TableCell extends internal_cjs.DateComponent{constructor(){super(...arguments),this.rootElRef=preact_cjs.createRef(),this.state={dayNumberId:internal_cjs.getUniqueDomId()},this.handleRootEl=e=>{internal_cjs.setRef(this.rootElRef,e),internal_cjs.setRef(this.props.elRef,e)}}render(){let{context:e,props:t,state:n,rootElRef:s}=this,{options:r,dateEnv:a}=e,{date:i,dateProfile:l}=t;const o=t.showDayNumber&&shouldDisplayMonthStart(i,l.currentRange,a);return preact_cjs.createElement(internal_cjs.DayCellContainer,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...t.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},t.extraDataAttrs),t.showDayNumber?{"aria-labelledby":n.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:renderTopInner,date:i,dateProfile:l,todayRange:t.todayRange,showDayNumber:t.showDayNumber,isMonthStart:o,extraRenderProps:t.extraRenderProps},((a,l)=>preact_cjs.createElement("div",{ref:t.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:t.minHeight}},t.showWeekNumber&&preact_cjs.createElement(internal_cjs.WeekNumberContainer,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:internal_cjs.buildNavLinkAttrs(e,i,"week"),date:i,defaultFormat:DEFAULT_WEEK_NUM_FORMAT}),!l.isDisabled&&(t.showDayNumber||internal_cjs.hasCustomDayCellContent(r)||t.forceDayTop)?preact_cjs.createElement("div",{className:"fc-daygrid-day-top"},preact_cjs.createElement(a,{elTag:"a",elClasses:["fc-daygrid-day-number",o&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},internal_cjs.buildNavLinkAttrs(e,i)),{id:n.dayNumberId})})):t.showDayNumber?preact_cjs.createElement("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},preact_cjs.createElement("a",{className:"fc-daygrid-day-number"}," ")):void 0,preact_cjs.createElement("div",{className:"fc-daygrid-day-events",ref:t.fgContentElRef},t.fgContent,preact_cjs.createElement("div",{className:"fc-daygrid-day-bottom",style:{marginTop:t.moreMarginTop}},preact_cjs.createElement(TableCellMoreLink,{allDayDate:i,singlePlacements:t.singlePlacements,moreCnt:t.moreCnt,alignmentElRef:s,alignGridTop:!t.showDayNumber,extraDateSpan:t.extraDateSpan,dateProfile:t.dateProfile,eventSelection:t.eventSelection,eventDrag:t.eventDrag,eventResize:t.eventResize,todayRange:t.todayRange}))),preact_cjs.createElement("div",{className:"fc-daygrid-day-bg"},t.bgContent))))}}function renderTopInner(e){return e.dayNumberText||preact_cjs.createElement(preact_cjs.Fragment,null," ")}function shouldDisplayMonthStart(e,t,n){const{start:s,end:r}=t,a=internal_cjs.addMs(r,-1),i=n.getYear(s),l=n.getMonth(s),o=n.getYear(a),c=n.getMonth(a);return!(i===o&&l===c)&&Boolean(e.valueOf()===s.valueOf()||1===n.getDay(e)&&e.valueOf()<r.valueOf())}function generateSegKey(e){return e.eventRange.instance.instanceId+":"+e.firstCol}function generateSegUid(e){return generateSegKey(e)+":"+e.lastCol}function computeFgSegPlacement(e,t,n,s,r,a,i){let l=new DayGridSegHierarchy((t=>{let n=e[t.index].eventRange.instance.instanceId+":"+t.span.start+":"+(t.span.end-1);return r[n]||1}));l.allowReslicing=!0,l.strictOrder=s,!0===t||!0===n?(l.maxCoord=a,l.hiddenConsumes=!0):"number"==typeof t?l.maxStackCnt=t:"number"==typeof n&&(l.maxStackCnt=n,l.hiddenConsumes=!0);let o=[],c=[];for(let t=0;t<e.length;t+=1){let n=e[t],s=generateSegUid(n);null!=r[s]?o.push({index:t,span:{start:n.firstCol,end:n.lastCol+1}}):c.push(n)}let d=l.addSegs(o),g=l.toRects(),{singleColPlacements:f,multiColPlacements:p,leftoverMargins:h}=placeRects(g,e,i),u=[],y=[];for(let e of c){p[e.firstCol].push({seg:e,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let t=e.firstCol;t<=e.lastCol;t+=1)f[t].push({seg:resliceSeg(e,t,t+1,i),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let e=0;e<i.length;e+=1)u.push(0);for(let t of d){let n=e[t.index],s=t.span;p[s.start].push({seg:resliceSeg(n,s.start,s.end,i),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let e=s.start;e<s.end;e+=1)u[e]+=1,f[e].push({seg:resliceSeg(n,e,e+1,i),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let e=0;e<i.length;e+=1)y.push(h[e]);return{singleColPlacements:f,multiColPlacements:p,moreCnts:u,moreMarginTops:y}}function placeRects(e,t,n){let s=groupRectsByEachCol(e,n.length),r=[],a=[],i=[];for(let e=0;e<n.length;e+=1){let l=s[e],o=[],c=0,d=0;for(let s of l){let r=t[s.index];o.push({seg:resliceSeg(r,e,e+1,n),isVisible:!0,isAbsolute:!1,absoluteTop:s.levelCoord,marginTop:s.levelCoord-c}),c=s.levelCoord+s.thickness}let g=[];c=0,d=0;for(let s of l){let r=t[s.index],a=s.span.end-s.span.start>1,i=s.span.start===e;d+=s.levelCoord-c,c=s.levelCoord+s.thickness,a?(d+=s.thickness,i&&g.push({seg:resliceSeg(r,s.span.start,s.span.end,n),isVisible:!0,isAbsolute:!0,absoluteTop:s.levelCoord,marginTop:0})):i&&(g.push({seg:resliceSeg(r,s.span.start,s.span.end,n),isVisible:!0,isAbsolute:!1,absoluteTop:s.levelCoord,marginTop:d}),d=0)}r.push(o),a.push(g),i.push(d)}return{singleColPlacements:r,multiColPlacements:a,leftoverMargins:i}}function groupRectsByEachCol(e,t){let n=[];for(let e=0;e<t;e+=1)n.push([]);for(let t of e)for(let e=t.span.start;e<t.span.end;e+=1)n[e].push(t);return n}function resliceSeg(e,t,n,s){if(e.firstCol===t&&e.lastCol===n-1)return e;let r=e.eventRange,a=r.range,i=internal_cjs.intersectRanges(a,{start:s[t].date,end:internal_cjs.addDays(s[n-1].date,1)});return Object.assign(Object.assign({},e),{firstCol:t,lastCol:n-1,eventRange:{def:r.def,ui:Object.assign(Object.assign({},r.ui),{durationEditable:!1}),instance:r.instance,range:i},isStart:e.isStart&&i.start.valueOf()===a.start.valueOf(),isEnd:e.isEnd&&i.end.valueOf()===a.end.valueOf()})}class DayGridSegHierarchy extends internal_cjs.SegHierarchy{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){const t=super.addSegs(e),{entriesByLevel:n}=this,s=e=>!this.forceHidden[internal_cjs.buildEntryKey(e)];for(let e=0;e<n.length;e+=1)n[e]=n[e].filter(s);return t}handleInvalidInsertion(e,t,n){const{entriesByLevel:s,forceHidden:r}=this,{touchingEntry:a,touchingLevel:i,touchingLateral:l}=e;if(this.hiddenConsumes&&a){const e=internal_cjs.buildEntryKey(a);if(!r[e])if(this.allowReslicing){const e=Object.assign(Object.assign({},a),{span:internal_cjs.intersectSpans(a.span,t.span)});r[internal_cjs.buildEntryKey(e)]=!0,s[i][l]=e,n.push(e),this.splitEntry(a,t,n)}else r[e]=!0,n.push(a)}super.handleInvalidInsertion(e,t,n)}}class TableRow extends internal_cjs.DateComponent{constructor(){super(...arguments),this.cellElRefs=new internal_cjs.RefMap,this.frameElRefs=new internal_cjs.RefMap,this.fgElRefs=new internal_cjs.RefMap,this.segHarnessRefs=new internal_cjs.RefMap,this.rootElRef=preact_cjs.createRef(),this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:t,context:n}=this,{options:s}=n,r=e.cells.length,a=splitSegsByFirstCol(e.businessHourSegs,r),i=splitSegsByFirstCol(e.bgEventSegs,r),l=splitSegsByFirstCol(this.getHighlightSegs(),r),o=splitSegsByFirstCol(this.getMirrorSegs(),r),{singleColPlacements:c,multiColPlacements:d,moreCnts:g,moreMarginTops:f}=computeFgSegPlacement(internal_cjs.sortEventSegs(e.fgEventSegs,s.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,s.eventOrderStrict,t.segHeights,t.maxContentHeight,e.cells),p=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return preact_cjs.createElement("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map(((t,n)=>{let s=this.renderFgSegs(n,e.forPrint?c[n]:d[n],e.todayRange,p),r=this.renderFgSegs(n,buildMirrorPlacements(o[n],d),e.todayRange,{},Boolean(e.eventDrag),Boolean(e.eventResize),!1);return preact_cjs.createElement(TableCell,{key:t.key,elRef:this.cellElRefs.createRef(t.key),innerElRef:this.frameElRefs.createRef(t.key),dateProfile:e.dateProfile,date:t.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&0===n,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:t.extraRenderProps,extraDataAttrs:t.extraDataAttrs,extraClassNames:t.extraClassNames,extraDateSpan:t.extraDateSpan,moreCnt:g[n],moreMarginTop:f[n],singlePlacements:c[n],fgContentElRef:this.fgElRefs.createRef(t.key),fgContent:preact_cjs.createElement(preact_cjs.Fragment,null,preact_cjs.createElement(preact_cjs.Fragment,null,s),preact_cjs.createElement(preact_cjs.Fragment,null,r)),bgContent:preact_cjs.createElement(preact_cjs.Fragment,null,this.renderFillSegs(l[n],"highlight"),this.renderFillSegs(a[n],"non-business"),this.renderFillSegs(i[n],"bg-event")),minHeight:e.cellMinHeight})})))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,t){let n=this.props;this.updateSizing(!internal_cjs.isPropsEqual(e,n))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,t,n,s,r,a,i){let{context:l}=this,{eventSelection:o}=this.props,{framePositions:c}=this.state,d=1===this.props.cells.length,g=r||a||i,f=[];if(c)for(let e of t){let{seg:t}=e,{instanceId:p}=t.eventRange.instance,h=e.isVisible&&!s[p],u=e.isAbsolute,y="",m="";u&&(l.isRtl?(m=0,y=c.lefts[t.lastCol]-c.lefts[t.firstCol]):(y=0,m=c.rights[t.firstCol]-c.rights[t.lastCol])),f.push(preact_cjs.createElement("div",{className:"fc-daygrid-event-harness"+(u?" fc-daygrid-event-harness-abs":""),key:generateSegKey(t),ref:g?null:this.segHarnessRefs.createRef(generateSegUid(t)),style:{visibility:h?"":"hidden",marginTop:u?"":e.marginTop,top:u?e.absoluteTop:"",left:y,right:m}},hasListItemDisplay(t)?preact_cjs.createElement(TableListItemEvent,Object.assign({seg:t,isDragging:r,isSelected:p===o,defaultDisplayEventEnd:d},internal_cjs.getSegMeta(t,n))):preact_cjs.createElement(TableBlockEvent,Object.assign({seg:t,isDragging:r,isResizing:a,isDateSelecting:i,isSelected:p===o,defaultDisplayEventEnd:d},internal_cjs.getSegMeta(t,n)))))}return f}renderFillSegs(e,t){let{isRtl:n}=this.context,{todayRange:s}=this.props,{framePositions:r}=this.state,a=[];if(r)for(let i of e){let e=n?{right:0,left:r.lefts[i.lastCol]-r.lefts[i.firstCol]}:{left:0,right:r.rights[i.firstCol]-r.rights[i.lastCol]};a.push(preact_cjs.createElement("div",{key:internal_cjs.buildEventRangeKey(i.eventRange),className:"fc-daygrid-bg-harness",style:e},"bg-event"===t?preact_cjs.createElement(internal_cjs.BgEvent,Object.assign({seg:i},internal_cjs.getSegMeta(i,s))):internal_cjs.renderFill(t)))}return preact_cjs.createElement(preact_cjs.Fragment,{},...a)}updateSizing(e){let{props:t,state:n,frameElRefs:s}=this;if(!t.forPrint&&null!==t.clientWidth){if(e){let e=t.cells.map((e=>s.currentMap[e.key]));if(e.length){let t=this.rootElRef.current,s=new internal_cjs.PositionCache(t,e,!0,!1);n.framePositions&&n.framePositions.similarTo(s)||this.setState({framePositions:new internal_cjs.PositionCache(t,e,!0,!1)})}}const r=this.state.segHeights,a=this.querySegHeights(),i=!0===t.dayMaxEvents||!0===t.dayMaxEventRows;this.safeSetState({segHeights:Object.assign(Object.assign({},r),a),maxContentHeight:i?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,t={};for(let n in e){let s=Math.round(e[n].getBoundingClientRect().height);t[n]=Math.max(t[n]||0,s)}return t}computeMaxContentHeight(){let e=this.props.cells[0].key,t=this.cellElRefs.currentMap[e],n=this.fgElRefs.currentMap[e];return t.getBoundingClientRect().bottom-n.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map((t=>e[t.key]))}}function buildMirrorPlacements(e,t){if(!e.length)return[];let n=buildAbsoluteTopHash(t);return e.map((e=>({seg:e,isVisible:!0,isAbsolute:!0,absoluteTop:n[e.eventRange.instance.instanceId],marginTop:0})))}function buildAbsoluteTopHash(e){let t={};for(let n of e)for(let e of n)t[e.seg.eventRange.instance.instanceId]=e.absoluteTop;return t}TableRow.addStateEquality({segHeights:internal_cjs.isPropsEqual});class TableRows extends internal_cjs.DateComponent{constructor(){super(...arguments),this.splitBusinessHourSegs=internal_cjs.memoize(splitSegsByRow),this.splitBgEventSegs=internal_cjs.memoize(splitSegsByRow),this.splitFgEventSegs=internal_cjs.memoize(splitSegsByRow),this.splitDateSelectionSegs=internal_cjs.memoize(splitSegsByRow),this.splitEventDrag=internal_cjs.memoize(splitInteractionByRow),this.splitEventResize=internal_cjs.memoize(splitInteractionByRow),this.rowRefs=new internal_cjs.RefMap}render(){let{props:e,context:t}=this,n=e.cells.length,s=this.splitBusinessHourSegs(e.businessHourSegs,n),r=this.splitBgEventSegs(e.bgEventSegs,n),a=this.splitFgEventSegs(e.fgEventSegs,n),i=this.splitDateSelectionSegs(e.dateSelectionSegs,n),l=this.splitEventDrag(e.eventDrag,n),o=this.splitEventResize(e.eventResize,n),c=n>=7&&e.clientWidth?e.clientWidth/t.options.aspectRatio/6:null;return preact_cjs.createElement(internal_cjs.NowTimer,{unit:"day"},((t,d)=>preact_cjs.createElement(preact_cjs.Fragment,null,e.cells.map(((t,g)=>preact_cjs.createElement(TableRow,{ref:this.rowRefs.createRef(g),key:t.length?t[0].date.toISOString():g,showDayNumbers:n>1,showWeekNumbers:e.showWeekNumbers,todayRange:d,dateProfile:e.dateProfile,cells:t,renderIntro:e.renderRowIntro,businessHourSegs:s[g],eventSelection:e.eventSelection,bgEventSegs:r[g].filter(isSegAllDay),fgEventSegs:a[g],dateSelectionSegs:i[g],eventDrag:l[g],eventResize:o[g],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:c,forPrint:e.forPrint}))))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){const e=this.rowRefs.currentMap[0].getCellEls()[0],t=e?e.closest(".fc-daygrid-body"):null;t&&(this.rootEl=t,this.context.registerInteractiveComponent(this,{el:t,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new internal_cjs.PositionCache(this.rootEl,this.rowRefs.collect().map((e=>e.getCellEls()[0])),!1,!0),this.colPositions=new internal_cjs.PositionCache(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,t){let{colPositions:n,rowPositions:s}=this,r=n.leftToIndex(e),a=s.topToIndex(t);if(null!=a&&null!=r){let e=this.props.cells[a][r];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(a,r),allDay:!0},e.extraDateSpan),dayEl:this.getCellEl(a,r),rect:{left:n.lefts[r],right:n.rights[r],top:s.tops[a],bottom:s.bottoms[a]},layer:0}}return null}getCellEl(e,t){return this.rowRefs.currentMap[e].getCellEls()[t]}getCellRange(e,t){let n=this.props.cells[e][t].date;return{start:n,end:internal_cjs.addDays(n,1)}}}function isSegAllDay(e){return e.eventRange.def.allDay}class Table extends internal_cjs.DateComponent{constructor(){super(...arguments),this.elRef=preact_cjs.createRef(),this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:t,dayMaxEvents:n,expandRows:s}=e,r=!0===n||!0===t;r&&!s&&(r=!1,t=null,n=null);let a=["fc-daygrid-body",r?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",s?"":"fc-daygrid-body-natural"];return preact_cjs.createElement("div",{ref:this.elRef,className:a.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},preact_cjs.createElement("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:s?e.clientHeight:""}},e.colGroupNode,preact_cjs.createElement("tbody",{role:"presentation"},preact_cjs.createElement(TableRows,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:n,dayMaxEventRows:t,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){const e=getScrollSubjectEl(this.elRef.current,this.props.dateProfile);if(e){const t=e.closest(".fc-daygrid-body"),n=t.closest(".fc-scroller"),s=e.getBoundingClientRect().top-t.getBoundingClientRect().top;n.scrollTop=s?s+1:0}this.needsScrollReset=!1}}}function getScrollSubjectEl(e,t){let n;return t.currentRangeUnit.match(/year|month/)&&(n=e.querySelector(`[data-date="${internal_cjs.formatIsoMonthStr(t.currentDate)}-01"]`)),n||(n=e.querySelector(`[data-date="${internal_cjs.formatDayString(t.currentDate)}"]`)),n}class DayTableSlicer extends internal_cjs.Slicer{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,t){return t.sliceRange(e)}}class DayTable extends internal_cjs.DateComponent{constructor(){super(...arguments),this.slicer=new DayTableSlicer,this.tableRef=preact_cjs.createRef()}render(){let{props:e,context:t}=this;return preact_cjs.createElement(Table,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,t,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}}class DayTableView extends TableView{constructor(){super(...arguments),this.buildDayTableModel=internal_cjs.memoize(buildDayTableModel),this.headerRef=preact_cjs.createRef(),this.tableRef=preact_cjs.createRef()}render(){let{options:e,dateProfileGenerator:t}=this.context,{props:n}=this,s=this.buildDayTableModel(n.dateProfile,t),r=e.dayHeaders&&preact_cjs.createElement(internal_cjs.DayHeader,{ref:this.headerRef,dateProfile:n.dateProfile,dates:s.headerDates,datesRepDistinctDays:1===s.rowCnt}),a=t=>preact_cjs.createElement(DayTable,{ref:this.tableRef,dateProfile:n.dateProfile,dayTableModel:s,businessHours:n.businessHours,dateSelection:n.dateSelection,eventStore:n.eventStore,eventUiBases:n.eventUiBases,eventSelection:n.eventSelection,eventDrag:n.eventDrag,eventResize:n.eventResize,nextDayThreshold:e.nextDayThreshold,colGroupNode:t.tableColGroupNode,tableMinWidth:t.tableMinWidth,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.weekNumbers,expandRows:!n.isHeightAuto,headerAlignElRef:this.headerElRef,clientWidth:t.clientWidth,clientHeight:t.clientHeight,forPrint:n.forPrint});return e.dayMinWidth?this.renderHScrollLayout(r,a,s.colCnt,e.dayMinWidth):this.renderSimpleLayout(r,a)}}function buildDayTableModel(e,t){let n=new internal_cjs.DaySeriesModel(e.renderRange,t);return new internal_cjs.DayTableModel(n,/year|month|week/.test(e.currentRangeUnit))}class TableDateProfileGenerator extends internal_cjs.DateProfileGenerator{buildRenderRange(e,t,n){let s=super.buildRenderRange(e,t,n),{props:r}=this;return buildDayTableRenderRange({currentRange:s,snapToWeek:/^(year|month)$/.test(t),fixedWeekCount:r.fixedWeekCount,dateEnv:r.dateEnv})}}function buildDayTableRenderRange(e){let t,{dateEnv:n,currentRange:s}=e,{start:r,end:a}=s;if(e.snapToWeek&&(r=n.startOfWeek(r),t=n.startOfWeek(a),t.valueOf()!==a.valueOf()&&(a=internal_cjs.addWeeks(t,1))),e.fixedWeekCount){let e=n.startOfWeek(n.startOfMonth(internal_cjs.addDays(s.end,-1))),t=Math.ceil(internal_cjs.diffWeeks(e,a));a=internal_cjs.addWeeks(a,6-t)}return{start:r,end:a}}var css_248z=':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}';internal_cjs.injectStyles(css_248z),exports.DayGridView=DayTableView,exports.DayTable=DayTable,exports.DayTableSlicer=DayTableSlicer,exports.Table=Table,exports.TableDateProfileGenerator=TableDateProfileGenerator,exports.TableRows=TableRows,exports.TableView=TableView,exports.buildDayTableModel=buildDayTableModel,exports.buildDayTableRenderRange=buildDayTableRenderRange;