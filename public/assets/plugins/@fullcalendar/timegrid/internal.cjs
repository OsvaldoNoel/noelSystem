"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var internal_cjs=require("@fullcalendar/core/internal.cjs"),preact_cjs=require("@fullcalendar/core/preact.cjs"),internal_cjs$1=require("@fullcalendar/daygrid/internal.cjs");class AllDaySplitter extends internal_cjs.Splitter{getKeyInfo(){return{allDay:{},timed:{}}}getKeysForDateSpan(e){return e.allDay?["allDay"]:["timed"]}getKeysForEventDef(e){return e.allDay?internal_cjs.hasBgRendering(e)?["timed","allDay"]:["allDay"]:["timed"]}}const DEFAULT_SLAT_LABEL_FORMAT=internal_cjs.createFormatter({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"short"});function TimeColsAxisCell(e){let t=["fc-timegrid-slot","fc-timegrid-slot-label",e.isLabeled?"fc-scrollgrid-shrink":"fc-timegrid-slot-minor"];return preact_cjs.createElement(internal_cjs.ViewContextType.Consumer,null,(r=>{if(!e.isLabeled)return preact_cjs.createElement("td",{className:t.join(" "),"data-time":e.isoTimeStr});let{dateEnv:n,options:i,viewApi:s}=r,l=null==i.slotLabelFormat?DEFAULT_SLAT_LABEL_FORMAT:Array.isArray(i.slotLabelFormat)?internal_cjs.createFormatter(i.slotLabelFormat[0]):internal_cjs.createFormatter(i.slotLabelFormat),o={level:0,time:e.time,date:n.toDate(e.date),view:s,text:n.format(e.date,l)};return preact_cjs.createElement(internal_cjs.ContentContainer,{elTag:"td",elClasses:t,elAttrs:{"data-time":e.isoTimeStr},renderProps:o,generatorName:"slotLabelContent",customGenerator:i.slotLabelContent,defaultGenerator:renderInnerContent,classNameGenerator:i.slotLabelClassNames,didMount:i.slotLabelDidMount,willUnmount:i.slotLabelWillUnmount},(e=>preact_cjs.createElement("div",{className:"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame"},preact_cjs.createElement(e,{elTag:"div",elClasses:["fc-timegrid-slot-label-cushion","fc-scrollgrid-shrink-cushion"]}))))}))}function renderInnerContent(e){return e.text}class TimeBodyAxis extends internal_cjs.BaseComponent{render(){return this.props.slatMetas.map((e=>preact_cjs.createElement("tr",{key:e.key},preact_cjs.createElement(TimeColsAxisCell,Object.assign({},e)))))}}const DEFAULT_WEEK_NUM_FORMAT=internal_cjs.createFormatter({week:"short"}),AUTO_ALL_DAY_MAX_EVENT_ROWS=5;class TimeColsView extends internal_cjs.DateComponent{constructor(){super(...arguments),this.allDaySplitter=new AllDaySplitter,this.headerElRef=preact_cjs.createRef(),this.rootElRef=preact_cjs.createRef(),this.scrollerElRef=preact_cjs.createRef(),this.state={slatCoords:null},this.handleScrollTopRequest=e=>{let t=this.scrollerElRef.current;t&&(t.scrollTop=e)},this.renderHeadAxis=(e,t="")=>{let{options:r}=this.context,{dateProfile:n}=this.props,i=n.renderRange,s=1===internal_cjs.diffDays(i.start,i.end)?internal_cjs.buildNavLinkAttrs(this.context,i.start,"week"):{};return r.weekNumbers&&"day"===e?preact_cjs.createElement(internal_cjs.WeekNumberContainer,{elTag:"th",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},date:i.start,defaultFormat:DEFAULT_WEEK_NUM_FORMAT},(e=>preact_cjs.createElement("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame","fc-timegrid-axis-frame-liquid"].join(" "),style:{height:t}},preact_cjs.createElement(e,{elTag:"a",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"],elAttrs:s})))):preact_cjs.createElement("th",{"aria-hidden":!0,className:"fc-timegrid-axis"},preact_cjs.createElement("div",{className:"fc-timegrid-axis-frame",style:{height:t}}))},this.renderTableRowAxis=e=>{let{options:t,viewApi:r}=this.context,n={text:t.allDayText,view:r};return preact_cjs.createElement(internal_cjs.ContentContainer,{elTag:"td",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},renderProps:n,generatorName:"allDayContent",customGenerator:t.allDayContent,defaultGenerator:renderAllDayInner,classNameGenerator:t.allDayClassNames,didMount:t.allDayDidMount,willUnmount:t.allDayWillUnmount},(t=>preact_cjs.createElement("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame",null==e?" fc-timegrid-axis-frame-liquid":""].join(" "),style:{height:e}},preact_cjs.createElement(t,{elTag:"span",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"]}))))},this.handleSlatCoords=e=>{this.setState({slatCoords:e})}}renderSimpleLayout(e,t,r){let{context:n,props:i}=this,s=[],l=internal_cjs.getStickyHeaderDates(n.options);return e&&s.push({type:"header",key:"header",isSticky:l,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),t&&(s.push({type:"body",key:"all-day",chunk:{content:t}}),s.push({type:"body",key:"all-day-divider",outerContent:preact_cjs.createElement("tr",{role:"presentation",className:"fc-scrollgrid-section"},preact_cjs.createElement("td",{className:"fc-timegrid-divider "+n.theme.getClass("tableCellShaded")}))})),s.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(n.options.expandRows),chunk:{scrollerElRef:this.scrollerElRef,content:r}}),preact_cjs.createElement(internal_cjs.ViewContainer,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:n.viewSpec},preact_cjs.createElement(internal_cjs.SimpleScrollGrid,{liquid:!i.isHeightAuto&&!i.forPrint,collapsibleWidth:i.forPrint,cols:[{width:"shrink"}],sections:s}))}renderHScrollLayout(e,t,r,n,i,s,l){let o=this.context.pluginHooks.scrollGridImpl;if(!o)throw new Error("No ScrollGrid implementation");let{context:a,props:c}=this,d=!c.forPrint&&internal_cjs.getStickyHeaderDates(a.options),m=!c.forPrint&&internal_cjs.getStickyFooterScrollbar(a.options),p=[];e&&p.push({type:"header",key:"header",isSticky:d,syncRowHeights:!0,chunks:[{key:"axis",rowContent:e=>preact_cjs.createElement("tr",{role:"presentation"},this.renderHeadAxis("day",e.rowSyncHeights[0]))},{key:"cols",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),t&&(p.push({type:"body",key:"all-day",syncRowHeights:!0,chunks:[{key:"axis",rowContent:e=>preact_cjs.createElement("tr",{role:"presentation"},this.renderTableRowAxis(e.rowSyncHeights[0]))},{key:"cols",content:t}]}),p.push({key:"all-day-divider",type:"body",outerContent:preact_cjs.createElement("tr",{role:"presentation",className:"fc-scrollgrid-section"},preact_cjs.createElement("td",{colSpan:2,className:"fc-timegrid-divider "+a.theme.getClass("tableCellShaded")}))}));let f=a.options.nowIndicator;return p.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(a.options.expandRows),chunks:[{key:"axis",content:e=>preact_cjs.createElement("div",{className:"fc-timegrid-axis-chunk"},preact_cjs.createElement("table",{"aria-hidden":!0,style:{height:e.expandRows?e.clientHeight:""}},e.tableColGroupNode,preact_cjs.createElement("tbody",null,preact_cjs.createElement(TimeBodyAxis,{slatMetas:s}))),preact_cjs.createElement("div",{className:"fc-timegrid-now-indicator-container"},preact_cjs.createElement(internal_cjs.NowTimer,{unit:f?"minute":"day"},(e=>{let t=f&&l&&l.safeComputeTop(e);return"number"==typeof t?preact_cjs.createElement(internal_cjs.NowIndicatorContainer,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:t},isAxis:!0,date:e}):null}))))},{key:"cols",scrollerElRef:this.scrollerElRef,content:r}]}),m&&p.push({key:"footer",type:"footer",isSticky:!0,chunks:[{key:"axis",content:internal_cjs.renderScrollShim},{key:"cols",content:internal_cjs.renderScrollShim}]}),preact_cjs.createElement(internal_cjs.ViewContainer,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:a.viewSpec},preact_cjs.createElement(o,{liquid:!c.isHeightAuto&&!c.forPrint,forPrint:c.forPrint,collapsibleWidth:!1,colGroups:[{width:"shrink",cols:[{width:"shrink"}]},{cols:[{span:n,minWidth:i}]}],sections:p}))}getAllDayMaxEventProps(){let{dayMaxEvents:e,dayMaxEventRows:t}=this.context.options;return!0!==e&&!0!==t||(e=void 0,t=5),{dayMaxEvents:e,dayMaxEventRows:t}}}function renderAllDayInner(e){return e.text}class TimeColsSlatsCoords{constructor(e,t,r){this.positions=e,this.dateProfile=t,this.slotDuration=r}safeComputeTop(e){let{dateProfile:t}=this;if(internal_cjs.rangeContainsMarker(t.currentRange,e)){let r=internal_cjs.startOfDay(e),n=e.valueOf()-r.valueOf();if(n>=internal_cjs.asRoughMs(t.slotMinTime)&&n<internal_cjs.asRoughMs(t.slotMaxTime))return this.computeTimeTop(internal_cjs.createDuration(n))}return null}computeDateTop(e,t){return t||(t=internal_cjs.startOfDay(e)),this.computeTimeTop(internal_cjs.createDuration(e.valueOf()-t.valueOf()))}computeTimeTop(e){let t,r,{positions:n,dateProfile:i}=this,s=n.els.length,l=(e.milliseconds-internal_cjs.asRoughMs(i.slotMinTime))/internal_cjs.asRoughMs(this.slotDuration);return l=Math.max(0,l),l=Math.min(s,l),t=Math.floor(l),t=Math.min(t,s-1),r=l-t,n.tops[t]+n.getHeight(t)*r}}class TimeColsSlatsBody extends internal_cjs.BaseComponent{render(){let{props:e,context:t}=this,{options:r}=t,{slatElRefs:n}=e;return preact_cjs.createElement("tbody",null,e.slatMetas.map(((i,s)=>{let l={time:i.time,date:t.dateEnv.toDate(i.date),view:t.viewApi};return preact_cjs.createElement("tr",{key:i.key,ref:n.createRef(i.key)},e.axis&&preact_cjs.createElement(TimeColsAxisCell,Object.assign({},i)),preact_cjs.createElement(internal_cjs.ContentContainer,{elTag:"td",elClasses:["fc-timegrid-slot","fc-timegrid-slot-lane",!i.isLabeled&&"fc-timegrid-slot-minor"],elAttrs:{"data-time":i.isoTimeStr},renderProps:l,generatorName:"slotLaneContent",customGenerator:r.slotLaneContent,classNameGenerator:r.slotLaneClassNames,didMount:r.slotLaneDidMount,willUnmount:r.slotLaneWillUnmount}))})))}}class TimeColsSlats extends internal_cjs.BaseComponent{constructor(){super(...arguments),this.rootElRef=preact_cjs.createRef(),this.slatElRefs=new internal_cjs.RefMap}render(){let{props:e,context:t}=this;return preact_cjs.createElement("div",{ref:this.rootElRef,className:"fc-timegrid-slots"},preact_cjs.createElement("table",{"aria-hidden":!0,className:t.theme.getClass("table"),style:{minWidth:e.tableMinWidth,width:e.clientWidth,height:e.minHeight}},e.tableColGroupNode,preact_cjs.createElement(TimeColsSlatsBody,{slatElRefs:this.slatElRefs,axis:e.axis,slatMetas:e.slatMetas})))}componentDidMount(){this.updateSizing()}componentDidUpdate(){this.updateSizing()}componentWillUnmount(){this.props.onCoords&&this.props.onCoords(null)}updateSizing(){let{context:e,props:t}=this;if(t.onCoords&&null!==t.clientWidth){this.rootElRef.current.offsetHeight&&t.onCoords(new TimeColsSlatsCoords(new internal_cjs.PositionCache(this.rootElRef.current,collectSlatEls(this.slatElRefs.currentMap,t.slatMetas),!1,!0),this.props.dateProfile,e.options.slotDuration))}}}function collectSlatEls(e,t){return t.map((t=>e[t.key]))}function splitSegsByCol(e,t){let r,n=[];for(r=0;r<t;r+=1)n.push([]);if(e)for(r=0;r<e.length;r+=1)n[e[r].col].push(e[r]);return n}function splitInteractionByCol(e,t){let r=[];if(e){for(let n=0;n<t;n+=1)r[n]={affectedInstances:e.affectedInstances,isEvent:e.isEvent,segs:[]};for(let t of e.segs)r[t.col].segs.push(t)}else for(let e=0;e<t;e+=1)r[e]=null;return r}class TimeColMoreLink extends internal_cjs.BaseComponent{render(){let{props:e}=this;return preact_cjs.createElement(internal_cjs.MoreLinkContainer,{elClasses:["fc-timegrid-more-link"],elStyle:{top:e.top,bottom:e.bottom},allDayDate:null,moreCnt:e.hiddenSegs.length,allSegs:e.hiddenSegs,hiddenSegs:e.hiddenSegs,extraDateSpan:e.extraDateSpan,dateProfile:e.dateProfile,todayRange:e.todayRange,popoverContent:()=>renderPlainFgSegs(e.hiddenSegs,e),defaultGenerator:renderMoreLinkInner,forceTimed:!0},(e=>preact_cjs.createElement(e,{elTag:"div",elClasses:["fc-timegrid-more-link-inner","fc-sticky"]})))}}function renderMoreLinkInner(e){return e.shortText}function buildPositioning(e,t,r){let n=new internal_cjs.SegHierarchy;null!=t&&(n.strictOrder=t),null!=r&&(n.maxStackCnt=r);let i=n.addSegs(e),s=internal_cjs.groupIntersectingEntries(i),l=buildWeb(n);return l=stretchWeb(l,1),{segRects:webToRects(l),hiddenGroups:s}}function buildWeb(e){const{entriesByLevel:t}=e,r=cacheable(((e,t)=>e+":"+t),((n,i)=>{let s=buildNodes(findNextLevelSegs(e,n,i),r),l=t[n][i];return[Object.assign(Object.assign({},l),{nextLevelNodes:s[0]}),l.thickness+s[1]]}));return buildNodes(t.length?{level:0,lateralStart:0,lateralEnd:t[0].length}:null,r)[0]}function buildNodes(e,t){if(!e)return[[],0];let{level:r,lateralStart:n,lateralEnd:i}=e,s=n,l=[];for(;s<i;)l.push(t(r,s)),s+=1;return l.sort(cmpDescPressures),[l.map(extractNode),l[0][1]]}function cmpDescPressures(e,t){return t[1]-e[1]}function extractNode(e){return e[0]}function findNextLevelSegs(e,t,r){let{levelCoords:n,entriesByLevel:i}=e,s=i[t][r],l=n[t]+s.thickness,o=n.length,a=t;for(;a<o&&n[a]<l;a+=1);for(;a<o;a+=1){let e,t=i[a],r=internal_cjs.binarySearch(t,s.span.start,internal_cjs.getEntrySpanEnd),n=r[0]+r[1],l=n;for(;(e=t[l])&&e.span.start<s.span.end;)l+=1;if(n<l)return{level:a,lateralStart:n,lateralEnd:l}}return null}function stretchWeb(e,t){const r=cacheable(((e,t,r)=>internal_cjs.buildEntryKey(e)),((e,n,i)=>{let s,{nextLevelNodes:l,thickness:o}=e,a=o+i,c=o/a,d=[];if(l.length)for(let e of l)if(void 0===s){let t=r(e,n,a);s=t[0],d.push(t[1])}else{let t=r(e,s,0);d.push(t[1])}else s=t;let m=(s-n)*c;return[s-m,Object.assign(Object.assign({},e),{thickness:m,nextLevelNodes:d})]}));return e.map((e=>r(e,0,0)[1]))}function webToRects(e){let t=[];const r=cacheable(((e,t,r)=>internal_cjs.buildEntryKey(e)),((e,r,i)=>{let s=Object.assign(Object.assign({},e),{levelCoord:r,stackDepth:i,stackForward:0});return t.push(s),s.stackForward=n(e.nextLevelNodes,r+e.thickness,i+1)+1}));function n(e,t,n){let i=0;for(let s of e)i=Math.max(r(s,t,n),i);return i}return n(e,0,0),t}function cacheable(e,t){const r={};return(...n)=>{let i=e(...n);return i in r?r[i]:r[i]=t(...n)}}function computeSegVCoords(e,t,r=null,n=0){let i=[];if(r)for(let s=0;s<e.length;s+=1){let l=e[s],o=r.computeDateTop(l.start,t),a=Math.max(o+(n||0),r.computeDateTop(l.end,t));i.push({start:Math.round(o),end:Math.round(a)})}return i}function computeFgSegPlacements(e,t,r,n){let i=[],s=[];for(let r=0;r<e.length;r+=1){let n=t[r];n?i.push({index:r,thickness:1,span:n}):s.push(e[r])}let{segRects:l,hiddenGroups:o}=buildPositioning(i,r,n),a=[];for(let t of l)a.push({seg:e[t.index],rect:t});for(let e of s)a.push({seg:e,rect:null});return{segPlacements:a,hiddenGroups:o}}const DEFAULT_TIME_FORMAT=internal_cjs.createFormatter({hour:"numeric",minute:"2-digit",meridiem:!1});class TimeColEvent extends internal_cjs.BaseComponent{render(){return preact_cjs.createElement(internal_cjs.StandardEvent,Object.assign({},this.props,{elClasses:["fc-timegrid-event","fc-v-event",this.props.isShort&&"fc-timegrid-event-short"],defaultTimeFormat:DEFAULT_TIME_FORMAT}))}}class TimeCol extends internal_cjs.BaseComponent{constructor(){super(...arguments),this.sortEventSegs=internal_cjs.memoize(internal_cjs.sortEventSegs)}render(){let{props:e,context:t}=this,{options:r}=t,n=r.selectMirror,i=e.eventDrag&&e.eventDrag.segs||e.eventResize&&e.eventResize.segs||n&&e.dateSelectionSegs||[],s=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{},l=this.sortEventSegs(e.fgEventSegs,r.eventOrder);return preact_cjs.createElement(internal_cjs.DayCellContainer,{elTag:"td",elRef:e.elRef,elClasses:["fc-timegrid-col",...e.extraClassNames||[]],elAttrs:Object.assign({role:"gridcell"},e.extraDataAttrs),date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,extraRenderProps:e.extraRenderProps},(t=>preact_cjs.createElement("div",{className:"fc-timegrid-col-frame"},preact_cjs.createElement("div",{className:"fc-timegrid-col-bg"},this.renderFillSegs(e.businessHourSegs,"non-business"),this.renderFillSegs(e.bgEventSegs,"bg-event"),this.renderFillSegs(e.dateSelectionSegs,"highlight")),preact_cjs.createElement("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(l,s,!1,!1,!1)),preact_cjs.createElement("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(i,{},Boolean(e.eventDrag),Boolean(e.eventResize),Boolean(n),"mirror")),preact_cjs.createElement("div",{className:"fc-timegrid-now-indicator-container"},this.renderNowIndicator(e.nowIndicatorSegs)),internal_cjs.hasCustomDayCellContent(r)&&preact_cjs.createElement(t,{elTag:"div",elClasses:["fc-timegrid-col-misc"]}))))}renderFgSegs(e,t,r,n,i,s){let{props:l}=this;return l.forPrint?renderPlainFgSegs(e,l):this.renderPositionedFgSegs(e,t,r,n,i,s)}renderPositionedFgSegs(e,t,r,n,i,s){let{eventMaxStack:l,eventShortHeight:o,eventOrderStrict:a,eventMinHeight:c}=this.context.options,{date:d,slatCoords:m,eventSelection:p,todayRange:f,nowDate:h}=this.props,g=r||n||i,u=computeSegVCoords(e,d,m,c),{segPlacements:v,hiddenGroups:b}=computeFgSegPlacements(e,u,a,l);return preact_cjs.createElement(preact_cjs.Fragment,null,this.renderHiddenGroups(b,e),v.map((e=>{let{seg:l,rect:a}=e,c=l.eventRange.instance.instanceId,d=g||Boolean(!t[c]&&a),m=computeSegVStyle(a&&a.span),u=!g&&a?this.computeSegHStyle(a):{left:0,right:0},v=Boolean(a)&&a.stackForward>0,b=Boolean(a)&&a.span.end-a.span.start<o;return preact_cjs.createElement("div",{className:"fc-timegrid-event-harness"+(v?" fc-timegrid-event-harness-inset":""),key:s||c,style:Object.assign(Object.assign({visibility:d?"":"hidden"},m),u)},preact_cjs.createElement(TimeColEvent,Object.assign({seg:l,isDragging:r,isResizing:n,isDateSelecting:i,isSelected:c===p,isShort:b},internal_cjs.getSegMeta(l,f,h))))})))}renderHiddenGroups(e,t){let{extraDateSpan:r,dateProfile:n,todayRange:i,nowDate:s,eventSelection:l,eventDrag:o,eventResize:a}=this.props;return preact_cjs.createElement(preact_cjs.Fragment,null,e.map((e=>{let c=computeSegVStyle(e.span),d=compileSegsFromEntries(e.entries,t);return preact_cjs.createElement(TimeColMoreLink,{key:internal_cjs.buildIsoString(internal_cjs.computeEarliestSegStart(d)),hiddenSegs:d,top:c.top,bottom:c.bottom,extraDateSpan:r,dateProfile:n,todayRange:i,nowDate:s,eventSelection:l,eventDrag:o,eventResize:a})})))}renderFillSegs(e,t){let{props:r,context:n}=this,i=computeSegVCoords(e,r.date,r.slatCoords,n.options.eventMinHeight).map(((n,i)=>{let s=e[i];return preact_cjs.createElement("div",{key:internal_cjs.buildEventRangeKey(s.eventRange),className:"fc-timegrid-bg-harness",style:computeSegVStyle(n)},"bg-event"===t?preact_cjs.createElement(internal_cjs.BgEvent,Object.assign({seg:s},internal_cjs.getSegMeta(s,r.todayRange,r.nowDate))):internal_cjs.renderFill(t))}));return preact_cjs.createElement(preact_cjs.Fragment,null,i)}renderNowIndicator(e){let{slatCoords:t,date:r}=this.props;return t?e.map(((e,n)=>preact_cjs.createElement(internal_cjs.NowIndicatorContainer,{key:n,elClasses:["fc-timegrid-now-indicator-line"],elStyle:{top:t.computeDateTop(e.start,r)},isAxis:!1,date:r}))):null}computeSegHStyle(e){let t,r,{isRtl:n,options:i}=this.context,s=i.slotEventOverlap,l=e.levelCoord,o=e.levelCoord+e.thickness;s&&(o=Math.min(1,l+2*(o-l))),n?(t=1-o,r=l):(t=l,r=1-o);let a={zIndex:e.stackDepth+1,left:100*t+"%",right:100*r+"%"};return s&&!e.stackForward&&(a[n?"marginLeft":"marginRight"]=20),a}}function renderPlainFgSegs(e,{todayRange:t,nowDate:r,eventSelection:n,eventDrag:i,eventResize:s}){let l=(i?i.affectedInstances:null)||(s?s.affectedInstances:null)||{};return preact_cjs.createElement(preact_cjs.Fragment,null,e.map((e=>{let i=e.eventRange.instance.instanceId;return preact_cjs.createElement("div",{key:i,style:{visibility:l[i]?"hidden":""}},preact_cjs.createElement(TimeColEvent,Object.assign({seg:e,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:i===n,isShort:!1},internal_cjs.getSegMeta(e,t,r))))})))}function computeSegVStyle(e){return e?{top:e.start,bottom:-e.end}:{top:"",bottom:""}}function compileSegsFromEntries(e,t){return e.map((e=>t[e.index]))}class TimeColsContent extends internal_cjs.BaseComponent{constructor(){super(...arguments),this.splitFgEventSegs=internal_cjs.memoize(splitSegsByCol),this.splitBgEventSegs=internal_cjs.memoize(splitSegsByCol),this.splitBusinessHourSegs=internal_cjs.memoize(splitSegsByCol),this.splitNowIndicatorSegs=internal_cjs.memoize(splitSegsByCol),this.splitDateSelectionSegs=internal_cjs.memoize(splitSegsByCol),this.splitEventDrag=internal_cjs.memoize(splitInteractionByCol),this.splitEventResize=internal_cjs.memoize(splitInteractionByCol),this.rootElRef=preact_cjs.createRef(),this.cellElRefs=new internal_cjs.RefMap}render(){let{props:e,context:t}=this,r=t.options.nowIndicator&&e.slatCoords&&e.slatCoords.safeComputeTop(e.nowDate),n=e.cells.length,i=this.splitFgEventSegs(e.fgEventSegs,n),s=this.splitBgEventSegs(e.bgEventSegs,n),l=this.splitBusinessHourSegs(e.businessHourSegs,n),o=this.splitNowIndicatorSegs(e.nowIndicatorSegs,n),a=this.splitDateSelectionSegs(e.dateSelectionSegs,n),c=this.splitEventDrag(e.eventDrag,n),d=this.splitEventResize(e.eventResize,n);return preact_cjs.createElement("div",{className:"fc-timegrid-cols",ref:this.rootElRef},preact_cjs.createElement("table",{role:"presentation",style:{minWidth:e.tableMinWidth,width:e.clientWidth}},e.tableColGroupNode,preact_cjs.createElement("tbody",{role:"presentation"},preact_cjs.createElement("tr",{role:"row"},e.axis&&preact_cjs.createElement("td",{"aria-hidden":!0,className:"fc-timegrid-col fc-timegrid-axis"},preact_cjs.createElement("div",{className:"fc-timegrid-col-frame"},preact_cjs.createElement("div",{className:"fc-timegrid-now-indicator-container"},"number"==typeof r&&preact_cjs.createElement(internal_cjs.NowIndicatorContainer,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:r},isAxis:!0,date:e.nowDate})))),e.cells.map(((t,r)=>preact_cjs.createElement(TimeCol,{key:t.key,elRef:this.cellElRefs.createRef(t.key),dateProfile:e.dateProfile,date:t.date,nowDate:e.nowDate,todayRange:e.todayRange,extraRenderProps:t.extraRenderProps,extraDataAttrs:t.extraDataAttrs,extraClassNames:t.extraClassNames,extraDateSpan:t.extraDateSpan,fgEventSegs:i[r],bgEventSegs:s[r],businessHourSegs:l[r],nowIndicatorSegs:o[r],dateSelectionSegs:a[r],eventDrag:c[r],eventResize:d[r],slatCoords:e.slatCoords,eventSelection:e.eventSelection,forPrint:e.forPrint})))))))}componentDidMount(){this.updateCoords()}componentDidUpdate(){this.updateCoords()}updateCoords(){let{props:e}=this;e.onColCoords&&null!==e.clientWidth&&e.onColCoords(new internal_cjs.PositionCache(this.rootElRef.current,collectCellEls(this.cellElRefs.currentMap,e.cells),!0,!1))}}function collectCellEls(e,t){return t.map((t=>e[t.key]))}class TimeCols extends internal_cjs.DateComponent{constructor(){super(...arguments),this.processSlotOptions=internal_cjs.memoize(processSlotOptions),this.state={slatCoords:null},this.handleRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e,isHitComboAllowed:this.props.isHitComboAllowed}):this.context.unregisterInteractiveComponent(this)},this.handleScrollRequest=e=>{let{onScrollTopRequest:t}=this.props,{slatCoords:r}=this.state;if(t&&r){if(e.time){let n=r.computeTimeTop(e.time);n=Math.ceil(n),n&&(n+=1),t(n)}return!0}return!1},this.handleColCoords=e=>{this.colCoords=e},this.handleSlatCoords=e=>{this.setState({slatCoords:e}),this.props.onSlatCoords&&this.props.onSlatCoords(e)}}render(){let{props:e,state:t}=this;return preact_cjs.createElement("div",{className:"fc-timegrid-body",ref:this.handleRootEl,style:{width:e.clientWidth,minWidth:e.tableMinWidth}},preact_cjs.createElement(TimeColsSlats,{axis:e.axis,dateProfile:e.dateProfile,slatMetas:e.slatMetas,clientWidth:e.clientWidth,minHeight:e.expandRows?e.clientHeight:"",tableMinWidth:e.tableMinWidth,tableColGroupNode:e.axis?e.tableColGroupNode:null,onCoords:this.handleSlatCoords}),preact_cjs.createElement(TimeColsContent,{cells:e.cells,axis:e.axis,dateProfile:e.dateProfile,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,todayRange:e.todayRange,nowDate:e.nowDate,nowIndicatorSegs:e.nowIndicatorSegs,clientWidth:e.clientWidth,tableMinWidth:e.tableMinWidth,tableColGroupNode:e.tableColGroupNode,slatCoords:t.slatCoords,onColCoords:this.handleColCoords,forPrint:e.forPrint}))}componentDidMount(){this.scrollResponder=this.context.createScrollResponder(this.handleScrollRequest)}componentDidUpdate(e){this.scrollResponder.update(e.dateProfile!==this.props.dateProfile)}componentWillUnmount(){this.scrollResponder.detach()}queryHit(e,t){let{dateEnv:r,options:n}=this.context,{colCoords:i}=this,{dateProfile:s}=this.props,{slatCoords:l}=this.state,{snapDuration:o,snapsPerSlot:a}=this.processSlotOptions(this.props.slotDuration,n.snapDuration),c=i.leftToIndex(e),d=l.positions.topToIndex(t);if(null!=c&&null!=d){let e=this.props.cells[c],n=l.positions.tops[d],m=l.positions.getHeight(d),p=(t-n)/m,f=d*a+Math.floor(p*a),h=this.props.cells[c].date,g=internal_cjs.addDurations(s.slotMinTime,internal_cjs.multiplyDuration(o,f)),u=r.add(h,g),v=r.add(u,o);return{dateProfile:s,dateSpan:Object.assign({range:{start:u,end:v},allDay:!1},e.extraDateSpan),dayEl:i.els[c],rect:{left:i.lefts[c],right:i.rights[c],top:n,bottom:n+m},layer:0}}return null}}function processSlotOptions(e,t){let r=t||e,n=internal_cjs.wholeDivideDurations(e,r);return null===n&&(r=e,n=1),{snapDuration:r,snapsPerSlot:n}}class DayTimeColsSlicer extends internal_cjs.Slicer{sliceRange(e,t){let r=[];for(let n=0;n<t.length;n+=1){let i=internal_cjs.intersectRanges(e,t[n]);i&&r.push({start:i.start,end:i.end,isStart:i.start.valueOf()===e.start.valueOf(),isEnd:i.end.valueOf()===e.end.valueOf(),col:n})}return r}}class DayTimeCols extends internal_cjs.DateComponent{constructor(){super(...arguments),this.buildDayRanges=internal_cjs.memoize(buildDayRanges),this.slicer=new DayTimeColsSlicer,this.timeColsRef=preact_cjs.createRef()}render(){let{props:e,context:t}=this,{dateProfile:r,dayTableModel:n}=e,{nowIndicator:i,nextDayThreshold:s}=t.options,l=this.buildDayRanges(n,r,t.dateEnv);return preact_cjs.createElement(internal_cjs.NowTimer,{unit:i?"minute":"day"},((o,a)=>preact_cjs.createElement(TimeCols,Object.assign({ref:this.timeColsRef},this.slicer.sliceProps(e,r,null,t,l),{forPrint:e.forPrint,axis:e.axis,dateProfile:r,slatMetas:e.slatMetas,slotDuration:e.slotDuration,cells:n.cells[0],tableColGroupNode:e.tableColGroupNode,tableMinWidth:e.tableMinWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight,expandRows:e.expandRows,nowDate:o,nowIndicatorSegs:i&&this.slicer.sliceNowDate(o,r,s,t,l),todayRange:a,onScrollTopRequest:e.onScrollTopRequest,onSlatCoords:e.onSlatCoords}))))}}function buildDayRanges(e,t,r){let n=[];for(let i of e.headerDates)n.push({start:r.add(i,t.slotMinTime),end:r.add(i,t.slotMaxTime)});return n}const STOCK_SUB_DURATIONS=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];function buildSlatMetas(e,t,r,n,i){let s=new Date(0),l=e,o=internal_cjs.createDuration(0),a=r||computeLabelInterval(n),c=[];for(;internal_cjs.asRoughMs(l)<internal_cjs.asRoughMs(t);){let e=i.add(s,l),t=null!==internal_cjs.wholeDivideDurations(o,a);c.push({date:e,time:l,key:e.toISOString(),isoTimeStr:internal_cjs.formatIsoTimeString(e),isLabeled:t}),l=internal_cjs.addDurations(l,n),o=internal_cjs.addDurations(o,n)}return c}function computeLabelInterval(e){let t,r,n;for(t=STOCK_SUB_DURATIONS.length-1;t>=0;t-=1)if(r=internal_cjs.createDuration(STOCK_SUB_DURATIONS[t]),n=internal_cjs.wholeDivideDurations(r,e),null!==n&&n>1)return r;return e}class DayTimeColsView extends TimeColsView{constructor(){super(...arguments),this.buildTimeColsModel=internal_cjs.memoize(buildTimeColsModel),this.buildSlatMetas=internal_cjs.memoize(buildSlatMetas)}render(){let{options:e,dateEnv:t,dateProfileGenerator:r}=this.context,{props:n}=this,{dateProfile:i}=n,s=this.buildTimeColsModel(i,r),l=this.allDaySplitter.splitProps(n),o=this.buildSlatMetas(i.slotMinTime,i.slotMaxTime,e.slotLabelInterval,e.slotDuration,t),{dayMinWidth:a}=e,c=!a,d=a,m=e.dayHeaders&&preact_cjs.createElement(internal_cjs.DayHeader,{dates:s.headerDates,dateProfile:i,datesRepDistinctDays:!0,renderIntro:c?this.renderHeadAxis:null}),p=!1!==e.allDaySlot&&(t=>preact_cjs.createElement(internal_cjs$1.DayTable,Object.assign({},l.allDay,{dateProfile:i,dayTableModel:s,nextDayThreshold:e.nextDayThreshold,tableMinWidth:t.tableMinWidth,colGroupNode:t.tableColGroupNode,renderRowIntro:c?this.renderTableRowAxis:null,showWeekNumbers:!1,expandRows:!1,headerAlignElRef:this.headerElRef,clientWidth:t.clientWidth,clientHeight:t.clientHeight,forPrint:n.forPrint},this.getAllDayMaxEventProps()))),f=t=>preact_cjs.createElement(DayTimeCols,Object.assign({},l.timed,{dayTableModel:s,dateProfile:i,axis:c,slotDuration:e.slotDuration,slatMetas:o,forPrint:n.forPrint,tableColGroupNode:t.tableColGroupNode,tableMinWidth:t.tableMinWidth,clientWidth:t.clientWidth,clientHeight:t.clientHeight,onSlatCoords:this.handleSlatCoords,expandRows:t.expandRows,onScrollTopRequest:this.handleScrollTopRequest}));return d?this.renderHScrollLayout(m,p,f,s.colCnt,a,o,this.state.slatCoords):this.renderSimpleLayout(m,p,f)}}function buildTimeColsModel(e,t){let r=new internal_cjs.DaySeriesModel(e.renderRange,t);return new internal_cjs.DayTableModel(r,!1)}var css_248z='.fc-v-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-v-event .fc-event-main{color:var(--fc-event-text-color);height:100%}.fc-v-event .fc-event-main-frame{display:flex;flex-direction:column;height:100%}.fc-v-event .fc-event-time{flex-grow:0;flex-shrink:0;max-height:100%;overflow:hidden}.fc-v-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-height:0}.fc-v-event .fc-event-title{bottom:0;max-height:100%;overflow:hidden;top:0}.fc-v-event:not(.fc-event-start){border-top-left-radius:0;border-top-right-radius:0;border-top-width:0}.fc-v-event:not(.fc-event-end){border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-width:0}.fc-v-event.fc-event-selected:before{left:-10px;right:-10px}.fc-v-event .fc-event-resizer-start{cursor:n-resize}.fc-v-event .fc-event-resizer-end{cursor:s-resize}.fc-v-event:not(.fc-event-selected) .fc-event-resizer{height:var(--fc-event-resizer-thickness);left:0;right:0}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-start{top:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer{left:50%;margin-left:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-start{top:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc .fc-timegrid .fc-daygrid-body{z-index:2}.fc .fc-timegrid-divider{padding:0 0 2px}.fc .fc-timegrid-body{min-height:100%;position:relative;z-index:1}.fc .fc-timegrid-axis-chunk{position:relative}.fc .fc-timegrid-axis-chunk>table,.fc .fc-timegrid-slots{position:relative;z-index:1}.fc .fc-timegrid-slot{border-bottom:0;height:1.5em}.fc .fc-timegrid-slot:empty:before{content:"\\00a0"}.fc .fc-timegrid-slot-minor{border-top-style:dotted}.fc .fc-timegrid-slot-label-cushion{display:inline-block;white-space:nowrap}.fc .fc-timegrid-slot-label{vertical-align:middle}.fc .fc-timegrid-axis-cushion,.fc .fc-timegrid-slot-label-cushion{padding:0 4px}.fc .fc-timegrid-axis-frame-liquid{height:100%}.fc .fc-timegrid-axis-frame{align-items:center;display:flex;justify-content:flex-end;overflow:hidden}.fc .fc-timegrid-axis-cushion{flex-shrink:0;max-width:60px}.fc-direction-ltr .fc-timegrid-slot-label-frame{text-align:right}.fc-direction-rtl .fc-timegrid-slot-label-frame{text-align:left}.fc-liquid-hack .fc-timegrid-axis-frame-liquid{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-timegrid-col-frame{min-height:100%;position:relative}.fc-media-screen.fc-liquid-hack .fc-timegrid-col-frame{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols{bottom:0;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols>table{height:100%}.fc-media-screen .fc-timegrid-col-bg,.fc-media-screen .fc-timegrid-col-events,.fc-media-screen .fc-timegrid-now-indicator-container{left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col-bg{z-index:2}.fc .fc-timegrid-col-bg .fc-non-business{z-index:1}.fc .fc-timegrid-col-bg .fc-bg-event{z-index:2}.fc .fc-timegrid-col-bg .fc-highlight{z-index:3}.fc .fc-timegrid-bg-harness{left:0;position:absolute;right:0}.fc .fc-timegrid-col-events{z-index:3}.fc .fc-timegrid-now-indicator-container{bottom:0;overflow:hidden}.fc-direction-ltr .fc-timegrid-col-events{margin:0 2.5% 0 2px}.fc-direction-rtl .fc-timegrid-col-events{margin:0 2px 0 2.5%}.fc-timegrid-event-harness{position:absolute}.fc-timegrid-event-harness>.fc-timegrid-event{bottom:0;left:0;position:absolute;right:0;top:0}.fc-timegrid-event-harness-inset .fc-timegrid-event,.fc-timegrid-event.fc-event-mirror,.fc-timegrid-more-link{box-shadow:0 0 0 1px var(--fc-page-bg-color)}.fc-timegrid-event,.fc-timegrid-more-link{border-radius:3px;font-size:var(--fc-small-font-size)}.fc-timegrid-event{margin-bottom:1px}.fc-timegrid-event .fc-event-main{padding:1px 1px 0}.fc-timegrid-event .fc-event-time{font-size:var(--fc-small-font-size);margin-bottom:1px;white-space:nowrap}.fc-timegrid-event-short .fc-event-main-frame{flex-direction:row;overflow:hidden}.fc-timegrid-event-short .fc-event-time:after{content:"\\00a0-\\00a0"}.fc-timegrid-event-short .fc-event-title{font-size:var(--fc-small-font-size)}.fc-timegrid-more-link{background:var(--fc-more-link-bg-color);color:var(--fc-more-link-text-color);cursor:pointer;margin-bottom:1px;position:absolute;z-index:9999}.fc-timegrid-more-link-inner{padding:3px 2px;top:0}.fc-direction-ltr .fc-timegrid-more-link{right:0}.fc-direction-rtl .fc-timegrid-more-link{left:0}.fc .fc-timegrid-now-indicator-line{border-color:var(--fc-now-indicator-color);border-style:solid;border-width:1px 0 0;left:0;position:absolute;right:0;z-index:4}.fc .fc-timegrid-now-indicator-arrow{border-color:var(--fc-now-indicator-color);border-style:solid;margin-top:-5px;position:absolute;z-index:4}.fc-direction-ltr .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 0 5px 6px;left:0}.fc-direction-rtl .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 6px 5px 0;right:0}';internal_cjs.injectStyles(css_248z),exports.DayTimeCols=DayTimeCols,exports.DayTimeColsSlicer=DayTimeColsSlicer,exports.DayTimeColsView=DayTimeColsView,exports.TimeCols=TimeCols,exports.TimeColsSlatsCoords=TimeColsSlatsCoords,exports.TimeColsView=TimeColsView,exports.buildDayRanges=buildDayRanges,exports.buildSlatMetas=buildSlatMetas,exports.buildTimeColsModel=buildTimeColsModel;